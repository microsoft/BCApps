namespace Microsoft.EServices.EDocumentConnector.Avalara;

using Microsoft.eServices.EDocument;
using Microsoft.Finance.GeneralLedger.Journal;
using Microsoft.Foundation.Attachment;
using Microsoft.Foundation.Reporting;
using Microsoft.Purchases.Document;
using Microsoft.Purchases.History;
using Microsoft.Sales.Customer;
using Microsoft.Sales.Document;
using Microsoft.Sales.FinanceCharge;
using Microsoft.Sales.History;
using Microsoft.Sales.Posting;
using Microsoft.Sales.Reminder;
using Microsoft.Service.Document;
using Microsoft.Service.History;
using Microsoft.Utilities;
using System.Automation;
using System.IO;
using System.Threading;
using System.Utilities;

codeunit 6800 "Avalara Functions"
{
    var
        AvalaraCategoryTok: Label 'Avalara', Locked = true;
        CannotAttachEmptyErr: Label 'Cannot attach empty content to E-Document %1', Comment = '%1 = E-Document Entry No';
        ConfirmOverwriteFieldsQst: Label 'The fields exist for %1. Do you want to over-write?', Comment = '%1 = Mandate code';

        // Format strings for StrSubstNo
        FailedToRetrieveMediaTypesMsg: Label 'Failed to retrieve media types for mandate %1', Comment = '%1 = Mandate';
        FetchAvalaraDocsDescTxt: Label 'Fetch Avalara documents for E-Documents';
        FieldsLoadedMsg: Label 'Loaded %1 fields for mandate %2', Comment = '%1 = Field count, %2 = Mandate code';
        FilterValueTrueTok: Label 'true', Locked = true;
        InvalidJsonResponseMsg: Label 'Invalid JSON response for mandate %1', Comment = '%1 = Mandate';
        JobQueueCreatedMsg: Label 'Job Queue Entry %1 created and set to Ready to run Codeunit %2 every %3 minutes.', Comment = '%1 = Job Queue Entry ID, %2 = Codeunit ID, %3 = Frequency in minutes';
        JobQueueExistsMsg: Label 'Job Queue Entry %1 already exists for Codeunit %2.', Comment = '%1 = Job Queue Entry ID, %2 = Codeunit ID';
        JsonFieldAcceptedValuesTok: Label 'acceptedValues', Locked = true;
        // JsonFieldDocumentTypeTok: Label 'documentType', Locked = true;
        JsonFieldFieldIdTok: Label 'fieldId', Locked = true;
        JsonFieldGetInvoiceMediaTypeTok: Label 'getInvoiceAvailableMediaType', Locked = true;
        JsonFieldNamespaceTok: Label 'namespace', Locked = true;
        JsonFieldPrefixTok: Label 'prefix', Locked = true;
        JsonFieldValueTok: Label 'value', Locked = true;
        MediaTypePdfTok: Label 'application/pdf', Locked = true;
        MediaTypeUblXmlTok: Label 'application/vnd.oasis.ubl+xml', Locked = true;
        MediaTypeXmlTok: Label 'application/xml', Locked = true;
        RetrievedMediaTypesMsg: Label 'Retrieved %1 media types for mandate %2', Comment = '%1 = Count, %2 = Mandate';
        SafeFilenameFormatMsg: Label '%1-%2%3', Comment = '%1 = File ID, %2 = Normalized media type, %3 = File extension', Locked = true;
        WorkflowCategoryEDocTok: Label 'EDOC', Locked = true;

    procedure AttachFromText(EDocument: Record "E-Document"; XmlText: Text; FileName: Text)
    var
        DocumentAttachment: Record "Document Attachment";
        TempBlob: Codeunit "Temp Blob";
        RecRef: RecordRef;
        InStr: InStream;
        OutStr: OutStream;
    begin
        if XmlText = '' then
            Error(CannotAttachEmptyErr, EDocument."Entry No");

        // Put the XML text into a stream
        TempBlob.CreateOutStream(OutStr, TextEncoding::UTF8);
        OutStr.WriteText(XmlText);
        TempBlob.CreateInStream(InStr, TextEncoding::UTF8);

        RecRef.GetTable(EDocument);

        // AllowDuplicateFileName = true to avoid name collisions
        DocumentAttachment.SaveAttachmentFromStream(InStr, RecRef, FileName, true);
    end;

    // procedure AttachFromInStream(EDocument: Record "E-Document"; var XmlIn: InStream; FileName: Text)
    // var
    //     DocumentAttachment: Record "Document Attachment";
    //     SalesInvoiceHeader: Record "Sales Invoice Header";
    //     RecRef: RecordRef;

    // begin
    //     if AttachmentFileExists(EDocument, FileName) then
    //         exit; // File already exists, skip duplicate attachment

    //     RecRef.GetTable(EDocument);
    //     DocumentAttachment.SaveAttachmentFromStream(XmlIn, RecRef, FileName, true);

    //     if SalesInvoiceHeader.Get(EDocument."Document No.") then
    //         AttachToPostedSalesInvoice(SalesInvoiceHeader, XmlIn, FileName);
    // end;

    procedure AttachmentFileExists(EDocument: Record "E-Document"; FileName: Text): Boolean
    var
        DocumentAttachment: Record "Document Attachment";
    begin
        DocumentAttachment.SetRange("File Name", FileName);
        DocumentAttachment.SetRange("Table ID", Database::"E-Document");
        DocumentAttachment.SetRange("No.", EDocument."Entry No".ToText());
        if not DocumentAttachment.IsEmpty then
            exit(true);
        exit(false);
    end;


    procedure AttachToPostedSalesInvoice(SalesInvHeader: Record "Sales Invoice Header"; InStream: InStream; FileName: Text)
    var
        DocAttach: Record "Document Attachment";
        RecRef: RecordRef;
    begin
        RecRef.GetTable(SalesInvHeader);
        DocAttach.SaveAttachmentFromStream(
            InStream,
            RecRef,
            FileName,
            true
        );
    end;

    procedure UpdateAttachments()
    var
        DocumentAttachment: Record "Document Attachment";
        EntryNo: Integer;
    begin
        DocumentAttachment.Reset();
        DocumentAttachment.SetRange("Table ID", Database::"E-Document");
        DocumentAttachment.SetFilter("No.", '<>%1', '');

        if DocumentAttachment.FindSet(true) then
            repeat
                if DocumentAttachment."E-Document Entry No." <> 0 then
                    continue;

                if not Evaluate(EntryNo, DocumentAttachment."No.") then
                    continue;

                DocumentAttachment.Validate("E-Document Entry No.", EntryNo);
                DocumentAttachment.Validate("E-Document Attachment", true);
                DocumentAttachment.Modify();
            until DocumentAttachment.Next() = 0;
    end;

    procedure LoadFieldsFromJson(FieldsArray: JsonArray; MandateInput: Text[40]; DocumentTypeInput: Text; DocumentVersionInput: Text)
    var
        AvalaraInputField: Record "Avalara Input Field";
        i: Integer;
        ItemObj: JsonObject;
        ItemToken: JsonToken;
    begin

        AvalaraInputField.SetRange(Mandate, MandateInput);
        AvalaraInputField.SetRange(DocumentType, DocumentTypeInput);
        AvalaraInputField.SetRange(DocumentVersion, DocumentVersionInput);

        if not AvalaraInputField.IsEmpty() then
            if Confirm(StrSubstNo(ConfirmOverwriteFieldsQst, MandateInput), true) then
                AvalaraInputField.DeleteAll()
            else
                exit;

        for i := 0 to FieldsArray.Count() - 1 do begin
            FieldsArray.Get(i, ItemToken);
            if not ItemToken.IsObject then
                Error('Invalid JSON at index %1: expected object.', i + 1);

            ItemObj := ItemToken.AsObject();

            AvalaraInputField.Init();

            // fieldId
            SetIntegerField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(FieldId),
                GetInt(ItemObj, JsonFieldFieldIdTok));

            // Straight mappings
            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(DocumentType),
                DocumentTypeInput);

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(DocumentVersion),
                GetText(ItemObj, 'documentVersion'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(Path),
                GetText(ItemObj, 'path'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(PathType),
                GetText(ItemObj, 'pathType'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(FieldName),
                GetText(ItemObj, 'fieldName'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(ExampleOrFixedValue),
                GetText(ItemObj, 'exampleOrFixedValue'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(DocumentationLink),
                GetText(ItemObj, 'documentationLink'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(DataType),
                GetText(ItemObj, 'dataType'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(Description),
                GetText(ItemObj, 'description'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(Optionality),
                GetText(ItemObj, 'optionality'));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(Cardinality),
                GetText(ItemObj, 'cardinality'));

            // namespace -> namespacePrefix / namespaceValue
            SetNamespace(ItemObj, AvalaraInputField);

            // acceptedValues[] -> pipe-separated
            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(AcceptedValues),
                GetAcceptedValues(ItemObj));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(Mandate),
                MandateInput);

            AvalaraInputField.Insert();
        end;

        Session.LogMessage('0000AVL', StrSubstNo(FieldsLoadedMsg, FieldsArray.Count(), MandateInput), Verbosity::Normal, DataClassification::SystemMetadata, TelemetryScope::ExtensionPublisher, 'Category', AvalaraCategoryTok);
    end;

    /// <summary>
    /// Get available media types for a specific mandate from Avalara API.
    /// Modern implementation using List of [Text] return type.
    /// </summary>
    /// <param name="Mandate">Mandate code (e.g., AU-B2B-PEPPOL).</param>
    /// <returns>List of unique media type strings (e.g., application/xml, application/pdf).</returns>
    procedure GetAvailableMediaTypesForMandate(Mandate: Text): List of [Text]
    var
        HttpExecutor: Codeunit "Http Executor";
        Request: Codeunit Requests;
        ValueArray: JsonArray;
        ResponseJson: JsonObject;
        MediaTypeList: List of [Text];
        ResponseContent: Text;
    begin
        // Validate input
        if Mandate = '' then begin
            Session.LogMessage('0000AVL', 'Empty mandate provided to GetAvailableMediaTypesForMandate', Verbosity::Warning, DataClassification::SystemMetadata, TelemetryScope::ExtensionPublisher, 'Category', AvalaraCategoryTok);
            exit(GetDefaultMediaTypes());
        end;

        // Call Avalara API
        Request.Init();
        Request.Authenticate().CreateGetMandates(Mandate);
        ResponseContent := HttpExecutor.ExecuteHttpRequest(Request);

        // Handle API failure
        if ResponseContent = '' then begin
            Session.LogMessage('0000AVL', StrSubstNo(FailedToRetrieveMediaTypesMsg, Mandate), Verbosity::Warning, DataClassification::SystemMetadata, TelemetryScope::ExtensionPublisher, 'Category', AvalaraCategoryTok);
            exit(GetDefaultMediaTypes());
        end;

        // Parse JSON response
        if not TryParseMediaTypesResponse(ResponseContent, ResponseJson, ValueArray) then begin
            Session.LogMessage('0000AVL', StrSubstNo(InvalidJsonResponseMsg, Mandate), Verbosity::Warning, DataClassification::SystemMetadata, TelemetryScope::ExtensionPublisher, 'Category', AvalaraCategoryTok);
            exit(GetDefaultMediaTypes());
        end;

        // Extract media types from response
        MediaTypeList := ExtractMediaTypesFromArray(ValueArray);

        // Fallback to defaults if no media types found
        if MediaTypeList.Count = 0 then
            exit(GetDefaultMediaTypes());

        Session.LogMessage('0000AVL', StrSubstNo(RetrievedMediaTypesMsg, MediaTypeList.Count, Mandate), Verbosity::Normal, DataClassification::SystemMetadata, TelemetryScope::ExtensionPublisher, 'Category', AvalaraCategoryTok);

        exit(MediaTypeList);
    end;

    local procedure TryParseMediaTypesResponse(ResponseContent: Text; var ResponseJson: JsonObject; var ValueArray: JsonArray): Boolean
    var
        ValueToken: JsonToken;
    begin
        // Parse root JSON object
        if not ResponseJson.ReadFrom(ResponseContent) then
            exit(false);

        // Get 'value' array from response
        if not ResponseJson.Get(JsonFieldValueTok, ValueToken) then
            exit(false);

        if not ValueToken.IsArray() then
            exit(false);

        ValueArray := ValueToken.AsArray();
        exit(true);
    end;

    local procedure ExtractMediaTypesFromArray(ValueArray: JsonArray): List of [Text]
    var
        ItemObject: JsonObject;
        ItemToken: JsonToken;
        MediaTypeList: List of [Text];
    begin
        foreach ItemToken in ValueArray do
            if ItemToken.IsObject() then begin
                ItemObject := ItemToken.AsObject();
                ExtractMediaTypesFromItem(ItemObject, MediaTypeList);
            end;

        exit(MediaTypeList);
    end;

    local procedure ExtractMediaTypesFromItem(ItemObject: JsonObject; var MediaTypeList: List of [Text])
    var
        ArrayElementToken: JsonToken;
        MediaTypeToken: JsonToken;
    begin
        // Look for 'getInvoiceAvailableMediaType' field
        if not ItemObject.Get(JsonFieldGetInvoiceMediaTypeTok, MediaTypeToken) then
            exit;

        // Handle array of media types
        if MediaTypeToken.IsArray() then begin
            foreach ArrayElementToken in MediaTypeToken.AsArray() do
                AddMediaTypeIfValid(ArrayElementToken, MediaTypeList);
            exit;
        end;

        // Handle single media type value
        if MediaTypeToken.IsValue() then
            AddMediaTypeIfValid(MediaTypeToken, MediaTypeList);
    end;

    local procedure AddMediaTypeIfValid(MediaTypeToken: JsonToken; var MediaTypeList: List of [Text])
    var
        MediaTypeValue: JsonValue;
        MediaTypeText: Text;
    begin
        if not MediaTypeToken.IsValue() then
            exit;

        MediaTypeValue := MediaTypeToken.AsValue();

        if MediaTypeValue.IsNull() then
            exit;

        MediaTypeText := MediaTypeValue.AsText();

        if MediaTypeText = '' then
            exit;

        // List.Contains handles duplicate checking automatically
        if not MediaTypeList.Contains(MediaTypeText) then
            MediaTypeList.Add(MediaTypeText);
    end;

    local procedure GetDefaultMediaTypes(): List of [Text]
    var
        DefaultMediaTypes: List of [Text];
    begin
        // Provide sensible defaults when API fails or returns no data
        DefaultMediaTypes.Add(MediaTypeXmlTok);
        DefaultMediaTypes.Add(MediaTypePdfTok);
        DefaultMediaTypes.Add(MediaTypeUblXmlTok);

        exit(DefaultMediaTypes);
    end;

    // -------- JSON helpers --------

    local procedure GetInt(var Obj: JsonObject; Name: Text): Integer
    var
        IntVal: Integer;
        T: JsonToken;
        V: JsonValue;
    begin
        if Obj.Get(Name, T) and T.IsValue then begin
            V := T.AsValue();

            if V.IsNull then
                exit(0);

            // Works for:
            // - JSON number (e.g. 123)
            // - JSON string containing digits (e.g. "123")
            if Evaluate(IntVal, V.AsText()) then
                exit(IntVal);
        end;

        exit(0);
    end;

    local procedure GetText(var Obj: JsonObject; Name: Text): Text
    var
        T: JsonToken;
        V: JsonValue;
    begin
        if Obj.Get(Name, T) and T.IsValue then begin
            V := T.AsValue();
            if V.IsNull then
                exit('');
            exit(V.AsText());
        end;
        exit('');
    end;

    local procedure GetAcceptedValues(var Obj: JsonObject): Text
    var
        i: Integer;
        Arr: JsonArray;
        ElemTok: JsonToken;
        T: JsonToken;
        V: JsonValue;
        ResultTxt: Text;
    begin
        if Obj.Get(JsonFieldAcceptedValuesTok, T) and T.IsArray then begin
            Arr := T.AsArray();
            for i := 0 to Arr.Count() - 1 do begin
                Arr.Get(i, ElemTok);
                if ElemTok.IsValue then begin
                    V := ElemTok.AsValue();
                    if not V.IsNull then begin
                        if ResultTxt <> '' then
                            ResultTxt += '|';
                        ResultTxt += V.AsText();
                    end;
                end;
            end;
        end;
        exit(ResultTxt);
    end;

    // -------- Namespace mapping --------

    local procedure SetNamespace(var ItemObj: JsonObject; var AvalaraInputField: Record "Avalara Input Field")
    var
        NsObj: JsonObject;
        T: JsonToken;
    begin
        if ItemObj.Get(JsonFieldNamespaceTok, T) and T.IsObject then begin
            NsObj := T.AsObject();

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(NamespacePrefix),
                GetText(NsObj, JsonFieldPrefixTok));

            SetTextField(
                AvalaraInputField,
                AvalaraInputField.FieldNo(NamespaceValue),
                GetText(NsObj, 'value'));
        end;
    end;

    // -------- Generic setter with length safety --------

    local procedure SetTextField(var AvalaraInputField: Record "Avalara Input Field"; FieldNo: Integer; Value: Text)
    var
        RecRef: RecordRef;
        FRef: FieldRef;
        MaxLen: Integer;
    begin
        RecRef.GetTable(AvalaraInputField);
        FRef := RecRef.Field(FieldNo);

        if FRef.Type in [FieldType::Text, FieldType::Code] then begin
            MaxLen := FRef.Length;
            if StrLen(Value) > MaxLen then
                Value := CopyStr(Value, 1, MaxLen);
        end;

        FRef.Value := Value;
        RecRef.SetTable(AvalaraInputField);
    end;

    local procedure SetIntegerField(var AvalaraInputField: Record "Avalara Input Field"; FieldNo: Integer; Value: Integer)
    var
        RecRef: RecordRef;
        FRef: FieldRef;
    begin
        RecRef.GetTable(AvalaraInputField);
        FRef := RecRef.Field(FieldNo);

        // Only set if the field is an Integer or BigInteger type
        case FRef.Type of
            FieldType::Integer,
            FieldType::BigInteger:
                FRef.Value := Value;
            else
                Error('SetIntegerField called on non-integer field %1.', FieldNo);
        end;

        RecRef.SetTable(AvalaraInputField);
    end;

    [EventSubscriber(ObjectType::Codeunit, Codeunit::"E-Doc. Export", OnBeforeEDocumentCheck, '', false, false)]
    local procedure EDocExportOnBeforeEDocumentCheck(RecRef: RecordRef; EDocumentProcessingPhase: Enum "E-Document Processing Phase"; var IsHandled: Boolean)
    var
        Customer: Record Customer;
        DocumentSendingProfile: Record "Document Sending Profile";
        FinChargeMemoHeader: Record "Finance Charge Memo Header";
        PurchaseHeader: Record "Purchase Header";
        SalesHeader: Record "Sales Header";
        WorkFlow: Record Workflow;
        CustomerNo, VendorNo : Text;
        EnabledFlowCode, RequiredFlowCode : Text;
    begin
        WorkFlow.SetFilter(Category, WorkflowCategoryEDocTok);
        WorkFlow.SetFilter(Enabled, FilterValueTrueTok);
        if WorkFlow.FindFirst() then
            EnabledFlowCode := WorkFlow.Code;

        CustomerNo := '';
        VendorNo := '';
        case RecRef.Number of
            Database::"Sales Header", Database::"Sales Invoice Header", Database::"Sales Cr.Memo Header":
                CustomerNo := RecRef.Field(SalesHeader.FieldNo("Bill-to Customer No.")).Value;
            Database::"Service Header", Database::"Service Invoice Header", Database::"Service Cr.Memo Header":
                CustomerNo := RecRef.Field(SalesHeader.FieldNo("Bill-to Customer No.")).Value;
            Database::"Finance Charge Memo Header", Database::"Issued Fin. Charge Memo Header", Database::"Reminder Header", Database::"Issued Reminder Header":
                CustomerNo := RecRef.Field(FinChargeMemoHeader.FieldNo("Customer No.")).Value;
            Database::"Purchase Header", Database::"Purch. Inv. Header", Database::"Purch. Cr. Memo Hdr.":
                VendorNo := RecRef.Field(PurchaseHeader.FieldNo("Pay-to Vendor No.")).Value;
        end;
        if CustomerNo <> '' then
            if Customer.Get(CustomerNo) then
                if DocumentSendingProfile.Get(Customer."Document Sending Profile") then begin
                    RequiredFlowCode := DocumentSendingProfile."Electronic Service Flow";
                    if (RequiredFlowCode <> EnabledFlowCode) and WorkFlow.Get(RequiredFlowCode) then
                        ; // Placeholder for future workflow enable logic
                end;
    end;

    procedure CreateBoilerPlateDefs(Mandate: Text)
    var
        DataExchDef: Record "Data Exch. Def";
        TempBlob: Codeunit "Temp Blob";
        XMLInStream: InStream;
        // %1 = Mandate prefix (e.g., 'AU-B2B-PEPPOL'), %2 = Display name for the data exchange definition
        DataExchangeCrMXML1Txt: Label '<?xml version="1.0" encoding="UTF-8" standalone="no"?><root><DataExchDef Code="%1PCM" Name="%2" Type="3" FileType="0" ReadingWritingCodeunit="1203" DataHandlingCodeunit="1214"><DataExchLineDef LineType="0" Code="PEPPOLCRMEMOHEADER" Name="PEPPOL - Credit Memo Header" ColumnCount="47" DataLineTag="/CreditNote" Namespace="urn:oasis:names:specification:ubl:schema:xsd:CreditNote-2"><DataExchColumnDef ColumnNo="1" Name="ID" Show="true" DataType="0" Description="Vendor Credit Memo No." Path="/CreditNote/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="2" Name="IssueDate" Show="true" DataType="0" Description="Order Date" Path="/CreditNote/cbc:IssueDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="3" Name="DocumentCurrencyCode" Show="true" DataType="0" Description="Credit Memo Currency Code" Path="/CreditNote/cbc:DocumentCurrencyCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="5" Name="OrderReferenceID" Show="false" DataType="0" Description="Vendor Order No." Path="/CreditNote/cac:OrderReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="6" Name="InvoiceDocumentReferenceId" Show="true" DataType="0" Description="Applies-to Doc. No." Path="/CreditNote/cac:BillingReference/cac:InvoiceDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="7" Name="SupplierEndpointGLNID" Show="true" DataType="0" Description="Buy-from Vendor GLN" Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cbc:EndpointID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="8" Name="SupplierEndpointVATID" Show="true" DataType="0" Description="Buy-from Vendor VAT Registration No." Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cbc:EndpointID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="9" Name="SupplierName" Show="false" DataType="0" Description="Buy-from Vendor Name" Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="10" Name="PartyLegalEntityCompanyIDGLN" Show="true" DataType="0" Description="Buy-from Vendor GLN" Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="11" Name="PartyLegalEntityCompanyIDVAT" Show="false" DataType="0" Description="Buy-from Vendor VAT Registration No." Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="12" Name="CustomerEndpointIDGLN" Show="true" DataType="0" Description="Company GLN" Path="/CreditNote/cac:AccountingCustomerParty/cac:Party/cbc:EndpointID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="13" Name="CustomerPartyIdentificationIDGLN" Show="true" DataType="0" Description="Company GLN" Path="/CreditNote/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="14" Name="CustPartyTaxSchemeCompanyID" Show="true" DataType="0" Description="Company VAT Registration No." Path="/CreditNote/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="15" Name="CustPartyLegalEntityCompanyID" Show="true" DataType="0" Description="Company VAT Registration No." Path="/CreditNote/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="16" Name="PartyLegalEntityName" Show="true" DataType="0" Description="Pay-to Vendor Name" Path="/CreditNote/cac:PayeeParty/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="17" Name="DiscountAmount" Show="true" DataType="0" Description="Invoice Discount Amount" Path="/CreditNote/cac:LegalMonetaryTotal/cbc:AllowanceTotalAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="18" Name="DiscountCurrencyID" Show="true" DataType="0" Description="Invoice Discount Currency Code" Path="/CreditNote/cac:AllowanceCharge/cbc:Amount/@currencyID[../cbc:ChargeIndicator/text() = ''false'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="19" Name="SupplierPartyIdentificationGLNID" Show="false" DataType="0" Description="Buy-from Vendor GLN" Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="20" Name="SupplierPartyIdentificationVATID" Show="false" DataType="0" Description="Buy-from Vendor VAT Registration No." Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="21" Name="ChargeAmount" Show="false" DataType="0" Description="Total Charge Amount" Path="/CreditNote/cac:AllowanceCharge/cbc:Amount[../cbc:ChargeIndicator/text() = ''true'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="22" Name="ChargeAmountCurrencyID" Show="false" DataType="0" Description="Charge Amount Currency Code" Path="/CreditNote/cac:AllowanceCharge/cbc:Amount/@currencyID[../cbc:ChargeIndicator/text() = ''true'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="23" Name="PrepaidAmount" Show="false" DataType="0" Description="Prepaid Amount" Path="/CreditNote/cac:LegalMonetaryTotal/cbc:PrepaidAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="24" Name="PrepaidAmountCurrencyID" Show="false" DataType="0" Description="Prepaid Amount Currency Code" Path="/CreditNote/cac:LegalMonetaryTotal/cbc:PrepaidAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="25" Name="PayableAmount" Show="true" DataType="0" Description="Total Amount including VAT, excl. Prepaid Amount" Path="/CreditNote/cac:LegalMonetaryTotal/cbc:PayableAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="26" Name="PayableAmountCurrencyID" Show="true" DataType="0" Description="Total Amount Currency Code" Path="/CreditNote/cac:LegalMonetaryTotal/cbc:PayableAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="27" Name="SupplierPartyContactReference" Show="false" DataType="0" Description="Your Reference" Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="28" Name="CustomerPartyName" Show="false" DataType="0" Description="Company Name" Path="/CreditNote/cac:AccountingCustomerParty/cac:Party/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="29" Name="CustomerPartyStreetName" Show="false" DataType="0" Description="Company Address" Path="/CreditNote/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="30" Name="SupplierStreetName" Show="false" DataType="0" Description="Buy-from Vendor Address" Path="/CreditNote/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="31" Name="PayeePartyLegalEntityCompanyIDGLN" Show="false" DataType="0" Description="Pay-to Vendor GLN" Path="/CreditNote/cac:PayeeParty/cac:PartyLegalEntity/cbc:CompanyID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="32" Name="PayeePartyLegalEntityCompanyIDVAT" Show="false" DataType="0" Description="Pay-to Vendor VAT Registration No." Path="/CreditNote/cac:PayeeParty/cac:PartyLegalEntity/cbc:CompanyID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="33" Name="PayeePartyCompanyIDGLN" Show="true" DataType="0" Description="Pya-to Vendor GLN" Path="/CreditNote/cac:PayeeParty/cac:PartyIdentification/cbc:ID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="34" Name="PayeePartyCompanyIDVAT" Show="false" DataType="0" Description="Pay-to Vendor VAT Registration No." Path="/CreditNote/cac:PayeeParty/cac:PartyIdentification/cbc:ID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="35" Name="ChargeReason" Show="false" DataType="0" Description="Charge Reason" Path="/CreditNote/cac:AllowanceCharge/cbc:AllowanceChargeReason[../cbc:ChargeIndicator/text() = ''true'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="36" Name="PaymentDueDate" Show="true" DataType="0" Description="Due Date" Path="/CreditNote/cac:PaymentMeans/cbc:PaymentDueDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="37" Name="CreditMemoDocumentReferenceId" Show="false" DataType="0" Description="Applies-to Doc. No." Path="/CreditNote/cac:BillingReference/cac:CreditNoteDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="38" Name="DocumentType" Show="false" DataType="0" Description="Document Type" Constant="Credit Memo" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="39" Name="AmountExclVAT" Show="false" DataType="0" Description="Total Amount excluding VAT" Path="/CreditNote/cac:LegalMonetaryTotal/cbc:TaxExclusiveAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="40" Name="Supplier IBAN" Show="false" DataType="0" Description="Buy-from Vendor IBAN" Path="/CreditNote/cac:PaymentMeans/cac:PayeeFinancialAccount/cbc:ID[@schemeID=''IBAN'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="41" Name="TexAmount" Show="false" DataType="0" Description="Total Tax Amount" Path="/CreditNote/cac:TaxTotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="42" Name="Supplier Bank Branch No." Show="false" DataType="0" Description="Buy-from Vendor Bank Branch No." Path="/CreditNote/cac:PaymentMeans/cac:PayeeFinancialAccount/cac:FinancialInstitutionBranch/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="43" Name="Supplier Bank Account No." Show="false" DataType="0" Description="Buy-from Vendor Bank Account No." Path="/CreditNote/cac:PaymentMeans/cac:PayeeFinancialAccount/cac:FinancialInstitutionBranch/cac:FinancialInstitution/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchMapping TableId="1214" UseAsIntermediateTable="true" Name="PEPPOL Credit Note to Purchase Credit Memo" PreMappingCodeunit="6156"><DataExchFieldMapping ColumnNo="1" TargetTableID="38" TargetFieldID="69" /><DataExchFieldMapping ColumnNo="2" TargetTableID="38" TargetFieldID="99" /><DataExchFieldMapping ColumnNo="3" TargetTableID="38" TargetFieldID="32" /><DataExchFieldMapping ColumnNo="5" TargetTableID="38" TargetFieldID="66" /><DataExchFieldMapping ColumnNo="6" TargetTableID="38" TargetFieldID="53" /><DataExchFieldMapping ColumnNo="7" TargetTableID="38" TargetFieldID="2" /><DataExchFieldMapping ColumnNo="8" TargetTableID="23" TargetFieldID="86" /><DataExchFieldMapping ColumnNo="9" TargetTableID="38" TargetFieldID="79" /><DataExchFieldMapping ColumnNo="12" Optional="true" TargetTableID="79" TargetFieldID="90" /><DataExchFieldMapping ColumnNo="13" Optional="true" TargetTableID="79" TargetFieldID="90" /><DataExchFieldMapping ColumnNo="14" Optional="true" TargetTableID="79" TargetFieldID="19" /><DataExchFieldMapping ColumnNo="15" Optional="true" TargetTableID="79" TargetFieldID="19" /><DataExchFieldMapping ColumnNo="16" TargetTableID="38" TargetFieldID="5" /><DataExchFieldMapping ColumnNo="17" Optional="true" TargetTableID="38" TargetFieldID="122" /><DataExchFieldMapping ColumnNo="18" Optional="true" TargetTableID="38" TargetFieldID="114" /><DataExchFieldMapping ColumnNo="19" TargetTableID="38" TargetFieldID="2" /><DataExchFieldMapping ColumnNo="20" TargetTableID="23" TargetFieldID="86" /><DataExchFieldMapping ColumnNo="21" Optional="true" TargetTableID="5805" TargetFieldID="11" /><DataExchFieldMapping ColumnNo="22" Optional="true" TargetTableID="38" TargetFieldID="114" /><DataExchFieldMapping ColumnNo="23" Optional="true" TargetTableID="461" TargetFieldID="3" /><DataExchFieldMapping ColumnNo="24" Optional="true" TargetTableID="38" TargetFieldID="114" /><DataExchFieldMapping ColumnNo="25" Optional="true" TargetTableID="38" TargetFieldID="61" /><DataExchFieldMapping ColumnNo="26" Optional="true" TargetTableID="38" TargetFieldID="114" /><DataExchFieldMapping ColumnNo="27" TargetTableID="38" TargetFieldID="11" /><DataExchFieldMapping ColumnNo="28" Optional="true" TargetTableID="79" TargetFieldID="2" /><DataExchFieldMapping ColumnNo="29" Optional="true" TargetTableID="79" TargetFieldID="4" /><DataExchFieldMapping ColumnNo="30" TargetTableID="38" TargetFieldID="81" /><DataExchFieldMapping ColumnNo="31" TargetTableID="38" TargetFieldID="4" /><DataExchFieldMapping ColumnNo="32" TargetTableID="38" TargetFieldID="70" /><DataExchFieldMapping ColumnNo="33" TargetTableID="38" TargetFieldID="4" /><DataExchFieldMapping ColumnNo="34" TargetTableID="38" TargetFieldID="70" /><DataExchFieldMapping ColumnNo="35" Optional="true" TargetTableID="5800" TargetFieldID="2" /><DataExchFieldMapping ColumnNo="36" TargetTableID="38" TargetFieldID="24" /><DataExchFieldMapping ColumnNo="38" TargetTableID="38" TargetFieldID="1" /><DataExchFieldMapping ColumnNo="39" Optional="true" TargetTableID="38" TargetFieldID="60" /><DataExchFieldMapping ColumnNo="40" Optional="true" TargetTableID="288" TargetFieldID="24" /><DataExchFieldMapping ColumnNo="41" TargetTableID="17" TargetFieldID="43" /><DataExchFieldMapping ColumnNo="42" Optional="true" TargetTableID="288" TargetFieldID="13" /><DataExchFieldMapping ColumnNo="43" Optional="true" TargetTableID="288" TargetFieldID="14" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="PEPPOLATTACHMENT" Name="PEPPOL - Attachments" ColumnCount="4" DataLineTag="/CreditNote/cac:AdditionalDocumentReference" ParentCode="PEPPOLCRMEMOHEADER"><DataExchColumnDef ColumnNo="1" Name="AdditionalDocumentReferenceID" Show="false" DataType="0" Description="AdditionalDocumentReference ID" Path="/CreditNote/cac:AdditionalDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="2" Name="EmbeddedDocumentBinaryObject" Show="false" DataType="0" Description="EmbeddedDocumentBinaryObject" Path="/CreditNote/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="3" Name="MimeCode" Show="false" DataType="0" Description="EmbeddedDocumentBinaryObject Mime Code" Path="/CreditNote/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject/@mimeCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="4" Name="Filename" Show="false" DataType="0" Description="EmbeddedDocumentBinaryObject Filename" Path="/CreditNote/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject/@filename" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchMapping TableId="1214" UseAsIntermediateTable="true" Name="PEPPOL to Document Attachments"><DataExchFieldMapping ColumnNo="1" TargetTableID="1173" TargetFieldID="1" /><DataExchFieldMapping ColumnNo="2" TargetTableID="1173" TargetFieldID="8" /><DataExchFieldMapping ColumnNo="3" TargetTableID="1173" TargetFieldID="7" /><DataExchFieldMapping ColumnNo="4" TargetTableID="1173" TargetFieldID="5" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="PEPPOLCRMEMOLINES" Name="PEPPOL - Credit Memo Lines" ColumnCount="18" DataLineTag="/CreditNote/cac:CreditNoteLine" ParentCode="PEPPOLCRMEMOHEADER"><DataExchColumnDef ColumnNo="1" Name="CreditNoteLineNote" Show="true" DataType="0" Path="/CreditNote/cac:CreditNoteLine/cbc:Note" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="2" Name="CreditedQuantity" Show="true" DataType="0" Description="Quantity" Path="/CreditNote/cac:CreditNoteLine/cbc:CreditedQuantity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="3" Name="unitCode" Show="true" DataType="0" Description="Unit of Measure" Path="/CreditNote/cac:CreditNoteLine/cbc:CreditedQuantity/@unitCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="4" Name="CreditNoteLineExtensionAmount" Show="true" DataType="0" Path="/CreditNote/cac:CreditNoteLine/cbc:LineExtensionAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="5" Name="LineExtensionAmountCurrencyID" Show="true" DataType="0" Description="Currency Code" Path="/CreditNote/cac:CreditNoteLine/cbc:LineExtensionAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="6" Name="InvLnDiscountAmount" Show="true" DataType="0" Description="Line Discount Amount" Path="/CreditNote/cac:CreditNoteLine/cac:AllowanceCharge[cbc:ChargeIndicator[text()=''false'']]/cbc:Amount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="7" Name="InvLnDiscountAmtCurrID" Show="true" DataType="0" Description="Currency Code" Path="/CreditNote/cac:CreditNoteLine/cac:AllowanceCharge/cbc:Amount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="8" Name="CreditNoteLineTaxAmount" Show="true" DataType="0" Description="Amount Including VAT" Path="/CreditNote/cac:CreditNoteLine/cac:TaxTotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="9" Name="currencyID" Show="true" DataType="0" Path="/CreditNote/cac:CreditNoteLine/cac:TaxTotal/cbc:TaxAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="10" Name="Description" Show="true" DataType="0" Description="Description" Path="/CreditNote/cac:CreditNoteLine/cac:Item/cbc:Description" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="11" Name="Name" Show="true" DataType="0" Description="Name" Path="/CreditNote/cac:CreditNoteLine/cac:Item/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="12" Name="SellersItemIdentificationID" Show="true" DataType="0" Description="Vendor''s Item No." Path="/CreditNote/cac:CreditNoteLine/cac:Item/cac:SellersItemIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="13" Name="StandardItemIdentificationID" Show="true" DataType="0" Description="GLN Schema" Path="/CreditNote/cac:CreditNoteLine/cac:Item/cac:StandardItemIdentification/cbc:ID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="15" Name="CreditNoteLineTaxPercent" Show="true" DataType="0" Description="VAT %" Path="/CreditNote/cac:CreditNoteLine/cac:Item/cac:ClassifiedTaxCategory/cbc:Percent" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="16" Name="CreditNoteLinePriceAmount" Show="true" DataType="0" Description="Direct Unit Cost" Path="/CreditNote/cac:CreditNoteLine/cac:Price/cbc:PriceAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="17" Name="InvLinePriceAmountCurrencyID" Show="true" DataType="0" Description="Currency Code" Path="/CreditNote/cac:CreditNoteLine/cac:Price/cbc:PriceAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="18" Name="BaseQuantity" Show="true" DataType="0" Description="Quantity (Base)" Path="/CreditNote/cac:CreditNoteLine/cac:Price/cbc:BaseQuantity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchMapping TableId="1214" UseAsIntermediateTable="true" Name="PEPPOL Credit Note to Purchase Credit Memo"><DataExchFieldMapping ColumnNo="2" TargetTableID="39" TargetFieldID="15" /><DataExchFieldMapping ColumnNo="3" TargetTableID="39" TargetFieldID="5407" /><DataExchFieldMapping ColumnNo="4" Optional="true" TargetTableID="39" TargetFieldID="29" /><DataExchFieldMapping ColumnNo="5" TargetTableID="39" TargetFieldID="91" /><DataExchFieldMapping ColumnNo="6" TargetTableID="39" TargetFieldID="28" /><DataExchFieldMapping ColumnNo="7" TargetTableID="39" TargetFieldID="91" /><DataExchFieldMapping ColumnNo="8" Optional="true" TargetTableID="39" TargetFieldID="30" /><DataExchFieldMapping ColumnNo="10" TargetTableID="39" TargetFieldID="12" /><DataExchFieldMapping ColumnNo="11" TargetTableID="39" TargetFieldID="11" /><DataExchFieldMapping ColumnNo="12" Optional="true" TargetTableID="39" TargetFieldID="5725" /><DataExchFieldMapping ColumnNo="13" TargetTableID="39" TargetFieldID="6" /><DataExchFieldMapping ColumnNo="15" Optional="true" TargetTableID="39" TargetFieldID="25" /><DataExchFieldMapping ColumnNo="16" TargetTableID="39" TargetFieldID="22" /><DataExchFieldMapping ColumnNo="17" TargetTableID="39" TargetFieldID="91" /><DataExchFieldMapping ColumnNo="18" Optional="true" TargetTableID="39" TargetFieldID="5415" /></DataExchMapping></DataExchLineDef></DataExchDef></root>', Locked = true;
        // %1 = Mandate prefix (e.g., 'AU-B2B-PEPPOL'), %2 = Display name for the data exchange definition
        DataExchangeInvXML1Txt: Label '<?xml version="1.0" encoding="UTF-8" standalone="no"?><root><DataExchDef Code="%1PINV" Name="%2" Type="3" FileType="0" ReadingWritingCodeunit="1203" DataHandlingCodeunit="1214"><DataExchLineDef LineType="0" Code="PEPPOLINVHEADER" Name="PEPPOL - Invoice Header" ColumnCount="47" DataLineTag="/Invoice" Namespace="urn:oasis:names:specification:ubl:schema:xsd:Invoice-2"><DataExchColumnDef ColumnNo="1" Name="ID" Show="true" DataType="0" Description="Vendor Invoice No." Path="/Invoice/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="2" Name="IssueDate" Show="true" DataType="0" Description="Order Date" Path="/Invoice/cbc:IssueDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="3" Name="DocumentCurrencyCode" Show="true" DataType="0" Description="Invoice Currency Code" Path="/Invoice/cbc:DocumentCurrencyCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="5" Name="OrderReferenceID" Show="true" DataType="0" Description="Vendor Order No." Path="/Invoice/cac:OrderReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="6" Name="SupplierEndpointGLNID" Show="true" DataType="0" Description="Buy-from Vendor GLN" Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cbc:EndpointID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="7" Name="SupplierEndpointVATID" Show="true" DataType="0" Description="Buy-from Vendor VAT Registration No." Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cbc:EndpointID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="8" Name="SupplierName" Show="false" DataType="0" Description="Buy-from Vendor Name" Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="9" Name="PartyLegalEntityCompanyIDGLN" Show="true" DataType="0" Description="Buy-from Vendor GLN" Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="10" Name="PartyLegalEntityCompanyIDVAT" Show="false" DataType="0" Description="Buy-from Vendor VAT Registration No." Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="11" Name="CustomerEndpointIDGLN" Show="true" DataType="0" Description="Company GLN" Path="/Invoice/cac:AccountingCustomerParty/cac:Party/cbc:EndpointID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="12" Name="CustomerPartyIdentificationIDGLN" Show="true" DataType="0" Description="Company GLN" Path="/Invoice/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="13" Name="CustPartyTaxSchemeCompanyID" Show="true" DataType="0" Description="Company VAT Registration No." Path="/Invoice/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="14" Name="CustPartyLegalEntityCompanyID" Show="true" DataType="0" Description="Company VAT Registration No." Path="/Invoice/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="16" Name="PartyLegalEntityName" Show="true" DataType="0" Description="Pay-to Vendor Name" Path="/Invoice/cac:PayeeParty/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="17" Name="DiscountAmount" Show="true" DataType="0" Description="Invoice Discount Amount" Path="/Invoice/cac:LegalMonetaryTotal/cbc:AllowanceTotalAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="18" Name="DiscountCurrencyID" Show="true" DataType="0" Description="Invoice Discount Currency Code" Path="/Invoice/cac:AllowanceCharge/cbc:Amount/@currencyID[../cbc:ChargeIndicator/text() = ''false'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="19" Name="SupplierPartyIdentificationGLNID" Show="false" DataType="0" Description="Buy-from Vendor GLN" Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="20" Name="SupplierPartyIdentificationVATID" Show="false" DataType="0" Description="Buy-from Vendor VAT Registration No." Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="21" Name="ChargeAmount" Show="false" DataType="0" Description="Total Charge Amount" Path="/Invoice/cac:AllowanceCharge/cbc:Amount[../cbc:ChargeIndicator/text() = ''true'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="22" Name="ChargeAmountCurrencyID" Show="false" DataType="0" Description="Charge Amount Currency Code" Path="/Invoice/cac:AllowanceCharge/cbc:Amount/@currencyID[../cbc:ChargeIndicator/text() = ''true'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="23" Name="PrepaidAmount" Show="false" DataType="0" Description="Prepaid Amount" Path="/Invoice/cac:LegalMonetaryTotal/cbc:PrepaidAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="24" Name="PrepaidAmountCurrencyID" Show="false" DataType="0" Description="Prepaid Amount Currency Code" Path="/Invoice/cac:LegalMonetaryTotal/cbc:PrepaidAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="25" Name="PayableAmount" Show="true" DataType="0" Description="Total Amount including VAT, excl. Prepaid Amount" Path="/Invoice/cac:LegalMonetaryTotal/cbc:PayableAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="26" Name="PayableAmountCurrencyID" Show="true" DataType="0" Description="Total Amount Currency Code" Path="/Invoice/cac:LegalMonetaryTotal/cbc:PayableAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="27" Name="SupplierPartyContactReference" Show="false" DataType="0" Description="Your Reference" Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="28" Name="CustomerPartyName" Show="false" DataType="0" Description="Company Name" Path="/Invoice/cac:AccountingCustomerParty/cac:Party/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="29" Name="CustomerPartyStreetName" Show="false" DataType="0" Description="Company Address" Path="/Invoice/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="30" Name="SupplierStreetName" Show="false" DataType="0" Description="Buy-from Vendor Address" Path="/Invoice/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="31" Name="PayeePartyLegalEntityCompanyIDGLN" Show="false" DataType="0" Description="Pay-to Vendor GLN" Path="/Invoice/cac:PayeeParty/cac:PartyLegalEntity/cbc:CompanyID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="32" Name="PayeePartyLegalEntityCompanyIDVAT" Show="false" DataType="0" Description="Pay-to Vendor VAT Registration No." Path="/Invoice/cac:PayeeParty/cac:PartyLegalEntity/cbc:CompanyID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="33" Name="PayeePartyCompanyIDGLN" Show="true" DataType="0" Description="Pay-to Vendor GLN" Path="/Invoice/cac:PayeeParty/cac:PartyIdentification/cbc:ID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="34" Name="PayeePartyCompanyIDVAT" Show="false" DataType="0" Description="Pay-to Vendor VAT Registration No." Path="/Invoice/cac:PayeeParty/cac:PartyIdentification/cbc:ID[@schemeID!=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="35" Name="ChargeReason" Show="false" DataType="0" Description="Charge Reason" Path="/Invoice/cac:AllowanceCharge/cbc:AllowanceChargeReason[../cbc:ChargeIndicator/text() = ''true'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="36" Name="DueDate" Show="true" DataType="0" Description="Due Date" Path="/Invoice/cbc:DueDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="37" Name="DocumentType" Show="false" DataType="0" Description="Document Type" Constant="Invoice" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="38" Name="AmountExclVAT" Show="false" DataType="0" Description="Total Amount excluding VAT" Path="/Invoice/cac:LegalMonetaryTotal/cbc:TaxExclusiveAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="39" Name="Supplier IBAN" Show="false" DataType="0" Description="Buy-from Vendor IBAN" Path="/Invoice/cac:PaymentMeans/cac:PayeeFinancialAccount/cbc:ID[@schemeID=''IBAN'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="40" Name="TaxAmount" Show="false" DataType="0" Description="Total Tax Amount" Path="/Invoice/cac:TaxTotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="41" Name="Supplier Bank Branch No." Show="false" DataType="0" Description="Buy-from Vendor Bank Branch No." Path="/Invoice/cac:PaymentMeans/cac:PayeeFinancialAccount/cac:FinancialInstitutionBranch/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="42" Name="Supplier Bank Account No." Show="false" DataType="0" Description="Buy-from Vendor Bank Account No." Path="/Invoice/cac:PaymentMeans/cac:PayeeFinancialAccount/cac:FinancialInstitutionBranch/cac:FinancialInstitution/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="43" Name="Attachment ID" Show="false" DataType="0" Path="/Invoice/cac:AdditionalDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchMapping TableId="1214" UseAsIntermediateTable="true" Name="PEPPOLSALESINVOICE to Purchase Invoice" PreMappingCodeunit="6156"><DataExchFieldMapping ColumnNo="1" TargetTableID="38" TargetFieldID="68" /><DataExchFieldMapping ColumnNo="2" TargetTableID="38" TargetFieldID="99" /><DataExchFieldMapping ColumnNo="3" TargetTableID="38" TargetFieldID="32" /><DataExchFieldMapping ColumnNo="5" TargetTableID="38" TargetFieldID="66" /><DataExchFieldMapping ColumnNo="6" TargetTableID="38" TargetFieldID="2" /><DataExchFieldMapping ColumnNo="7" TargetTableID="23" TargetFieldID="86" /><DataExchFieldMapping ColumnNo="8" TargetTableID="38" TargetFieldID="79" /><DataExchFieldMapping ColumnNo="11" Optional="true" TargetTableID="79" TargetFieldID="90" /><DataExchFieldMapping ColumnNo="12" Optional="true" TargetTableID="79" TargetFieldID="90" /><DataExchFieldMapping ColumnNo="13" Optional="true" TargetTableID="79" TargetFieldID="19" /><DataExchFieldMapping ColumnNo="14" Optional="true" TargetTableID="79" TargetFieldID="19" /><DataExchFieldMapping ColumnNo="16" TargetTableID="38" TargetFieldID="5" /><DataExchFieldMapping ColumnNo="17" Optional="true" TargetTableID="38" TargetFieldID="122" /><DataExchFieldMapping ColumnNo="18" Optional="true" TargetTableID="38" TargetFieldID="114" /><DataExchFieldMapping ColumnNo="19" TargetTableID="38" TargetFieldID="2" /><DataExchFieldMapping ColumnNo="20" TargetTableID="23" TargetFieldID="86" /><DataExchFieldMapping ColumnNo="21" Optional="true" TargetTableID="5805" TargetFieldID="11" /><DataExchFieldMapping ColumnNo="22" Optional="true" TargetTableID="38" TargetFieldID="114" /><DataExchFieldMapping ColumnNo="23" Optional="true" TargetTableID="461" TargetFieldID="3" /><DataExchFieldMapping ColumnNo="24" Optional="true" TargetTableID="38" TargetFieldID="114" /><DataExchFieldMapping ColumnNo="25" Optional="true" TargetTableID="38" TargetFieldID="61" /><DataExchFieldMapping ColumnNo="26" Optional="true" TargetTableID="38" TargetFieldID="114" /><DataExchFieldMapping ColumnNo="27" TargetTableID="38" TargetFieldID="11" /><DataExchFieldMapping ColumnNo="28" Optional="true" TargetTableID="79" TargetFieldID="2" /><DataExchFieldMapping ColumnNo="29" Optional="true" TargetTableID="79" TargetFieldID="4" /><DataExchFieldMapping ColumnNo="30" TargetTableID="38" TargetFieldID="81" /><DataExchFieldMapping ColumnNo="31" TargetTableID="38" TargetFieldID="4" /><DataExchFieldMapping ColumnNo="32" TargetTableID="38" TargetFieldID="70" /><DataExchFieldMapping ColumnNo="33" TargetTableID="38" TargetFieldID="4" /><DataExchFieldMapping ColumnNo="34" TargetTableID="38" TargetFieldID="70" /><DataExchFieldMapping ColumnNo="35" Optional="true" TargetTableID="5800" TargetFieldID="2" /><DataExchFieldMapping ColumnNo="36" TargetTableID="38" TargetFieldID="24" /><DataExchFieldMapping ColumnNo="37" TargetTableID="38" TargetFieldID="1" /><DataExchFieldMapping ColumnNo="38" Optional="true" TargetTableID="38" TargetFieldID="60" /><DataExchFieldMapping ColumnNo="39" Optional="true" TargetTableID="288" TargetFieldID="24" /><DataExchFieldMapping ColumnNo="40" TargetTableID="17" TargetFieldID="43" /><DataExchFieldMapping ColumnNo="41" Optional="true" TargetTableID="288" TargetFieldID="13" /><DataExchFieldMapping ColumnNo="42" Optional="true" TargetTableID="288" TargetFieldID="14" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="PEPPOLATTACHMENT" Name="PEPPOL - Attachments" ColumnCount="4" DataLineTag="/Invoice/cac:AdditionalDocumentReference" ParentCode="PEPPOLINVHEADER"><DataExchColumnDef ColumnNo="1" Name="ID" Show="false" DataType="0" Description="AdditionalDocumentReference ID" Path="/Invoice/cac:AdditionalDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="2" Name="Binary Object" Show="false" DataType="0" Description="Binary Object" Path="/Invoice/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="3" Name="Binary Object Mime Code" Show="false" DataType="0" Description="Binary Object Mime Code" Path="/Invoice/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject/@mimeCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="4" Name="Binary Object Filename" Show="false" DataType="0" Description="Binary Object Filename" Path="/Invoice/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject/@filename" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchMapping TableId="1214" UseAsIntermediateTable="true" Name="PEPPOL to Document Attachments"><DataExchFieldMapping ColumnNo="1" TargetTableID="1173" TargetFieldID="1" /><DataExchFieldMapping ColumnNo="2" TargetTableID="1173" TargetFieldID="8" /><DataExchFieldMapping ColumnNo="3" TargetTableID="1173" TargetFieldID="7" /><DataExchFieldMapping ColumnNo="4" TargetTableID="1173" TargetFieldID="5" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="PEPPOLINVLINES" Name="PEPPOL - Invoice Lines" ColumnCount="18" DataLineTag="/Invoice/cac:InvoiceLine" ParentCode="PEPPOLINVHEADER"><DataExchColumnDef ColumnNo="1" Name="InvoiceLineNote" Show="true" DataType="0" Path="/Invoice/cac:InvoiceLine/cbc:Note" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="2" Name="InvoicedQuantity" Show="true" DataType="0" Description="Quantity" Path="/Invoice/cac:InvoiceLine/cbc:InvoicedQuantity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="3" Name="unitCode" Show="true" DataType="0" Description="Unit of Measure" Path="/Invoice/cac:InvoiceLine/cbc:InvoicedQuantity/@unitCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="4" Name="InvoiceLineExtensionAmount" Show="true" DataType="0" Path="/Invoice/cac:InvoiceLine/cbc:LineExtensionAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="5" Name="LineExtensionAmountCurrencyID" Show="true" DataType="0" Description="Currency Code" Path="/Invoice/cac:InvoiceLine/cbc:LineExtensionAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="6" Name="InvLnDiscountAmount" Show="true" DataType="0" Description="Line Discount Amount" Path="/Invoice/cac:InvoiceLine/cac:AllowanceCharge[cbc:ChargeIndicator[text()=''false'']]/cbc:Amount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="7" Name="InvLnDiscountAmtCurrID" Show="true" DataType="0" Description="Currency Code" Path="/Invoice/cac:InvoiceLine/cac:AllowanceCharge/cbc:Amount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="8" Name="InvoiceLineTaxAmount" Show="true" DataType="0" Description="Amount Including VAT" Path="/Invoice/cac:InvoiceLine/cac:TaxTotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="9" Name="currencyID" Show="true" DataType="0" Path="/Invoice/cac:InvoiceLine/cac:TaxTotal/cbc:TaxAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="10" Name="Description" Show="true" DataType="0" Description="Description" Path="/Invoice/cac:InvoiceLine/cac:Item/cbc:Description" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="11" Name="Name" Show="true" DataType="0" Description="Name" Path="/Invoice/cac:InvoiceLine/cac:Item/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="12" Name="SellersItemIdentificationID" Show="true" DataType="0" Description="Vendor''s Item No." Path="/Invoice/cac:InvoiceLine/cac:Item/cac:SellersItemIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="13" Name="StandardItemIdentificationID" Show="true" DataType="0" Description="GLN Schema" Path="/Invoice/cac:InvoiceLine/cac:Item/cac:StandardItemIdentification/cbc:ID[@schemeID=''0088'']" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="15" Name="InvoiceLineTaxPercent" Show="true" DataType="0" Description="VAT %" Path="/Invoice/cac:InvoiceLine/cac:Item/cac:ClassifiedTaxCategory/cbc:Percent" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="16" Name="InvoiceLinePriceAmount" Show="true" DataType="0" Description="Direct Unit Cost" Path="/Invoice/cac:InvoiceLine/cac:Price/cbc:PriceAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="17" Name="InvLinePriceAmountCurrencyID" Show="true" DataType="0" Description="Currency Code" Path="/Invoice/cac:InvoiceLine/cac:Price/cbc:PriceAmount/@currencyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="18" Name="BaseQuantity" Show="true" DataType="0" Description="Quantity (Base)" Path="/Invoice/cac:InvoiceLine/cac:Price/cbc:BaseQuantity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchMapping TableId="1214" UseAsIntermediateTable="true" Name="PEPPOLSALESINVOICE to Sales Invoice"><DataExchFieldMapping ColumnNo="2" TargetTableID="39" TargetFieldID="15" /><DataExchFieldMapping ColumnNo="3" TargetTableID="39" TargetFieldID="5407" /><DataExchFieldMapping ColumnNo="4" Optional="true" TargetTableID="39" TargetFieldID="29" /><DataExchFieldMapping ColumnNo="5" TargetTableID="39" TargetFieldID="91" /><DataExchFieldMapping ColumnNo="6" TargetTableID="39" TargetFieldID="28" /><DataExchFieldMapping ColumnNo="7" TargetTableID="39" TargetFieldID="91" /><DataExchFieldMapping ColumnNo="8" Optional="true" TargetTableID="39" TargetFieldID="30" /><DataExchFieldMapping ColumnNo="10" TargetTableID="39" TargetFieldID="12" /><DataExchFieldMapping ColumnNo="11" TargetTableID="39" TargetFieldID="11" /><DataExchFieldMapping ColumnNo="12" Optional="true" TargetTableID="39" TargetFieldID="5725" /><DataExchFieldMapping ColumnNo="13" TargetTableID="39" TargetFieldID="6" /><DataExchFieldMapping ColumnNo="15" Optional="true" TargetTableID="39" TargetFieldID="25" /><DataExchFieldMapping ColumnNo="16" TargetTableID="39" TargetFieldID="22" /><DataExchFieldMapping ColumnNo="17" TargetTableID="39" TargetFieldID="91" /><DataExchFieldMapping ColumnNo="18" Optional="true" TargetTableID="39" TargetFieldID="5415" /></DataExchMapping></DataExchLineDef></DataExchDef></root>', Comment = '%1=Mandate prefix; %2=Display name for the data exchange definition';
        DataExchangeXMLSalCrMemoExp1Txt: Label '<?xml version="1.0" encoding="UTF-8" standalone="no"?><root><DataExchDef Code="%1SCM" Name="%2" Type="5" ExternalDataHandlingCodeunit="6155" FileType="0" ReadingWritingCodeunit="1283"><DataExchLineDef LineType="1" Code="01-CRNOTE" Name="CreditNote" ColumnCount="0" Namespace="urn:oasis:names:specification:ubl:schema:xsd:CreditNote-2"><DataExchColumnDef ColumnNo="1" Name="CreditNote" Show="false" DataType="0" Path="/CreditNote" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="2" Name="CustomizationID" Show="false" DataType="0" Path="/CreditNote/cbc:CustomizationID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="ProfileID" Show="false" DataType="0" Path="/CreditNote/cbc:ProfileID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="ID" Show="false" DataType="0" Path="/CreditNote/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="IssueDate" Show="false" DataType="1" Path="/CreditNote/cbc:IssueDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="CreditNoteTypeCode" Show="false" DataType="0" Path="/CreditNote/cbc:CreditNoteTypeCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="Note" Show="false" DataType="0" Path="/CreditNote/cbc:Note" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="TaxPointDate" Show="false" DataType="0" Path="/CreditNote/cbc:TaxPointDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="DocumentCurrencyCode" Show="false" DataType="0" Path="/CreditNote/cbc:DocumentCurrencyCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="TaxCurrencyCode" Show="false" DataType="0" Path="/CreditNote/cbc:TaxCurrencyCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="AccountingCost" Show="false" DataType="0" Path="/CreditNote/cbc:AccountingCost" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="BuyerReference" Show="false" DataType="0" Path="/CreditNote/cbc:BuyerReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="2" UseDefaultValue="true" DefaultValue="urn:cen.eu:en16931:2017#compliant#urn:fdc:peppol.eu:2017:poacc:billing:3.0" /><DataExchFieldMapping ColumnNo="3" UseDefaultValue="true" DefaultValue="urn:fdc:peppol.eu:2017:poacc:billing:01:1.0" /><DataExchFieldMapping ColumnNo="4" FieldID="3" /><DataExchFieldMapping ColumnNo="5" FieldID="99" /><DataExchFieldMapping ColumnNo="7" UseDefaultValue="true" DefaultValue="381" /><DataExchFieldMapping ColumnNo="10" FieldID="32" Optional="true" /><DataExchFieldMapping ColumnNo="13" FieldID="11" Optional="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="02-INVPERIOD" Name="Invoice Period" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="InvoicePeriod" Show="false" DataType="0" Path="/cac:InvoicePeriod" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="StartDate" Show="false" DataType="1" Path="/cac:InvoicePeriod/cbc:StartDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="EndDate" Show="false" DataType="1" Path="/cac:InvoicePeriod/cbc:EndDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="2" UseDefaultValue="true" /><DataExchFieldMapping ColumnNo="3" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="03-ORDREF" Name="Order Reference" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="OrderReference" Show="false" DataType="0" Path="/cac:OrderReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ID" Show="false" DataType="0" Path="/cac:OrderReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="2" FieldID="100" Optional="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="04-BILLINGREF" Name="Billing Reference" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="BillingReference" Show="false" DataType="0" Path="/cac:BillingReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="InvoiceDocumentReference" Show="false" DataType="0" Path="/cac:BillingReference/cac:InvoiceDocumentReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="ID" Show="false" DataType="0" Path="/cac:BillingReference/cac:InvoiceDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="IssueDate" Show="false" DataType="1" Path="/cac:BillingReference/cac:InvoiceDocumentReference/cbc:IssueDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="05-CONTDOCREF" Name="Contract Document Reference" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="ContractDocumentReference" Show="false" DataType="0" Path="/cac:ContractDocumentReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ID" Show="false" DataType="0" Path="/cac:ContractDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="2" FieldID="3" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="06-ADDDOCREF" Name="Additional Document Reference" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="AdditionalDocumentReference" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ID" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="DocumentType" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cbc:DocumentType" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="Attachment" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="EmbeddedDocumentBinaryObject" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="ExternalReference" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cac:ExternalReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="URI" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cac:ExternalReference/cbc:URI" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="MimeCode" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject[@mimeCode]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="Filename" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject[@filename]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="1173" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="07-ACCSUPPPARTY" Name="Accounting Supplier Party" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="AccountingSupplierParty" Show="false" DataType="0" Path="/cac:AccountingSupplierParty" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="Party" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="EndpointID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cbc:EndpointID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cbc:EndpointID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="PartyIdentification" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="ID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="PartyName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="Name" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="PostalAddress" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="StreetName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="AdditionalStreetName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:AdditionalStreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="CityName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="14" Name="PostalZone" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:PostalZone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="15" Name="CountrySubentity" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="16" Name="Country" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cac:Country" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="17" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cac:Country/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="18" Name="PartyTaxScheme" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="19" Name="CompanyID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="20" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="21" Name="ExemptionReason" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cbc:ExemptionReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="22" Name="TaxScheme" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="23" Name="ID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="24" Name="PartyLegalEntity" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="25" Name="RegistrationName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:RegistrationName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="26" Name="CompanyID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="27" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="28" Name="Contact" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="29" Name="Name" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="30" Name="Telephone" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:Telephone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="31" Name="Telefax" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:Telefax" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="32" Name="ElectronicMail" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:ElectronicMail" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="79" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="9" FieldID="2" /><DataExchFieldMapping ColumnNo="25" FieldID="2" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="08-ACCCUSTPARTY" Name="Accounting Customer Party" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="AccountingSupplierParty" Show="false" DataType="0" Path="/cac:AccountingCustomerParty" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="Party" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="EndpointID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cbc:EndpointID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cbc:EndpointID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="PartyIdentification" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="ID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="PartyName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="Name" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="PostalAddress" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="StreetName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="AdditionalStreetName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:AdditionalStreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="CityName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:CityName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="14" Name="PostalZone" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:PostalZone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="15" Name="CountrySubentity" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="16" Name="Country" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cac:Country" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="17" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cac:Country/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="18" Name="PartyTaxScheme" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="19" Name="CompanyID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="20" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="21" Name="ExemptionReason" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cbc:ExemptionReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="22" Name="TaxScheme" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="23" Name="ID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="24" Name="PartyLegalEntity" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="25" Name="RegistrationName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:RegistrationName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="26" Name="CompanyID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="27" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="28" Name="Contact" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="29" Name="Name" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="30" Name="Telephone" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:Telephone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="31" Name="Telefax" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:Telefax" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="32" Name="ElectronicMail" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:ElectronicMail" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="9" FieldID="5" /><DataExchFieldMapping ColumnNo="11" FieldID="7" /><DataExchFieldMapping ColumnNo="12" FieldID="8" Optional="true" /><DataExchFieldMapping ColumnNo="13" FieldID="9" /><DataExchFieldMapping ColumnNo="14" FieldID="85" /><DataExchFieldMapping ColumnNo="15" FieldID="86" Optional="true" /><DataExchFieldMapping ColumnNo="17" FieldID="87" TransformationRule="LOOKUPISOCOUTRYCODE"><TransformationRules><Code>LOOKUPISOCOUTRYCODE</Code><Description>Lookup ISO Country code</Description><TransformationType>13</TransformationType><FindValue /><ReplaceValue /><StartPosition>0</StartPosition><Length>0</Length><DataFormat /><DataFormattingCulture /><NextTransformationRule /><TableID>9</TableID><SourceFieldID>1</SourceFieldID><TargetFieldID>4</TargetFieldID><FieldLookupRule>0</FieldLookupRule><Precision>0.00</Precision><Direction /><ExportFromDateType>0</ExportFromDateType></TransformationRules></DataExchFieldMapping></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="09-TAXREPRPARTY" Name="Tax Representative Party" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="TaxRepresentativeParty" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="PartyName" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="Name" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="PartyTaxScheme" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="CompanyID" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="schemeID" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="TaxScheme" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="ID" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="10-DELIVERY" Name="Delivery" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="Delivery" Show="false" DataType="0" Path="/cac:Delivery" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ActualDeliveryDate" Show="false" DataType="0" Path="/cac:Delivery/cbc:ActualDeliveryDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="DeliveryLocation" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="ID" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="schemeID" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="Address" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="StreetName" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="AdditionalStreetName" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:AdditionalStreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="CityName" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:CityName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="PostalZone" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:PostalZone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="CountrySubentity" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:CountrySubentity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="Country" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cac:Country" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cac:Country/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="7" FieldID="15" /><DataExchFieldMapping ColumnNo="8" FieldID="16" Optional="true" /><DataExchFieldMapping ColumnNo="9" FieldID="17" /><DataExchFieldMapping ColumnNo="10" FieldID="91" /><DataExchFieldMapping ColumnNo="11" FieldID="92" Optional="true" /><DataExchFieldMapping ColumnNo="13" FieldID="93" TransformationRule="LOOKUPISOCOUTRYCODE"><TransformationRules><Code>LOOKUPISOCOUTRYCODE</Code><Description>Lookup ISO Country code</Description><TransformationType>13</TransformationType><FindValue /><ReplaceValue /><StartPosition>0</StartPosition><Length>0</Length><DataFormat /><DataFormattingCulture /><NextTransformationRule /><TableID>9</TableID><SourceFieldID>1</SourceFieldID><TargetFieldID>4</TargetFieldID><FieldLookupRule>0</FieldLookupRule><Precision>0.00</Precision><Direction /><ExportFromDateType>0</ExportFromDateType></TransformationRules></DataExchFieldMapping></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="11-PMTMEANS" Name="Payment Means" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="PaymentMeans" Show="false" DataType="0" Path="/cac:PaymentMeans" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="PaymentMeansCode" Show="false" DataType="0" Path="/cac:PaymentMeans/cbc:PaymentMeansCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="PaymentChannelCode" Show="false" DataType="0" Path="/cac:PaymentMeans/cbc:PaymentChannelCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="PaymentID" Show="false" DataType="0" Path="/cac:PaymentMeans/cbc:PaymentID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="CardAccount" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:CardAccount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="PrimaryAccountNumberID" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:CardAccount/cbc:PrimaryAccountNumberID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="NetworkID" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:CardAccount/cbc:NetworkID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="PayeeFinancialAccount" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:PayeeFinancialAccount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="ID" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:PayeeFinancialAccount/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="FinancialInstitutionBranch" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:PayeeFinancialAccount/cac:FinancialInstitutionBranch" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="ID" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:PayeeFinancialAccount/cac:FinancialInstitutionBranch/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="12-PMTTERMS" Name="Payment Terms" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="PaymentTerms" Show="false" DataType="0" Path="/cac:PaymentTerms" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="Note" Show="false" DataType="0" Path="/cac:PaymentTerms/cbc:Note" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="13-ALLCHARGE" Name="Allowance Charge" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="AllowanceCharge" Show="false" DataType="0" Path="/cac:AllowanceCharge" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ChargeIndicator" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:ChargeIndicator" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="AllowanceChargeReasonCode" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:AllowanceChargeReasonCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="AllowanceChargeReason" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:AllowanceChargeReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="Amount" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:Amount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="currencyID" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:Amount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="TaxCategory" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="ID" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="Percent" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory/cbc:Percent" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="TaxScheme" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="ID" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="2000000026" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="14-TAXTOTAL" Name="Tax Total" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="TaxTotal" Show="false" DataType="0" Path="/cac:TaxTotal" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="TaxAmount" Show="false" DataType="0" Path="/cac:TaxTotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="currencyID" Show="false" DataType="0" Path="/cac:TaxTotal/cbc:TaxAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="16-TAXTOTALLCY" Name="Tax Total LCY" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="TaxTotal" Show="false" DataType="0" Path="/cac:TaxTotal" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="TaxAmount" Show="false" DataType="0" Path="/cac:TaxTotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="currencyID" Show="false" DataType="0" Path="/cac:TaxTotal/cbc:TaxAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="17-LEGALMONTOTAL" Name="Legal Monetary Total" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="LegalMonetaryTotal" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="LineExtensionAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:LineExtensionAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:LineExtensionAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="TaxExclusiveAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:TaxExclusiveAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:TaxExclusiveAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="TaxInclusiveAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:TaxInclusiveAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:TaxInclusiveAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="AllowanceTotalAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:AllowanceTotalAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:AllowanceTotalAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="ChargeTotalAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:ChargeTotalAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:ChargeTotalAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="PrepaidAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PrepaidAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PrepaidAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="14" Name="PayableRoundingAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PayableRoundingAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="15" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PayableRoundingAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="16" Name="PayableAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PayableAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="17" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PayableAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="114" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="18-CREDITNOTE-LINES" Name="Credit Note Line" ColumnCount="0" DataLineTag="/CreditNote" ParentCode="01-CRNOTE"><DataExchColumnDef ColumnNo="1" Name="Line" Show="false" DataType="0" Path="/cac:CreditNoteLine" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ID" Show="false" DataType="2" Path="/cac:CreditNoteLine/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="Note" Show="false" DataType="0" Path="/cac:CreditNoteLine/cbc:Note" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="InvoicedQuantity" Show="false" DataType="2" Path="/cac:CreditNoteLine/cbc:CreditedQuantity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="unitCode" Show="false" DataType="0" Path="/cac:CreditNoteLine/cbc:CreditedQuantity[@unitCode]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="LineExtensionAmount" Show="false" DataType="2" Description="Set to line amount" Path="/cac:CreditNoteLine/cbc:LineExtensionAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="currencyID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cbc:LineExtensionAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="AccountingCost" Show="false" DataType="0" Path="/cac:CreditNoteLine/cbc:AccountingCost" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="InvoicePeriod" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:InvoicePeriod" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="StartDate" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:InvoicePeriod/cbc:StartDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="EndDate" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:InvoicePeriod/cbc:EndDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="OrderLineReference" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:OrderLineReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="LineID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:OrderLineReference/cbc:LineID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="14" Name="BillingReference" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:BillingReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="15" Name="InvoiceDocumentReference" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:BillingReference/cac:InvoiceDocumentReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="16" Name="ID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:BillingReference/cac:InvoiceDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="17" Name="CreditNoteDocumentReference" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:BillingReference/cac:CreditNoteDocumentReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="18" Name="ID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:BillingReference/cac:CreditNoteDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="19" Name="BillingReferenceLine" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:BillingReference/cac:BillingReferenceLine" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="20" Name="ID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:BillingReference/cac:BillingReferenceLine/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="21" Name="Delivery" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="22" Name="ActualDeliveryDate" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cbc:ActualDeliveryDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="23" Name="DeliveryLocation" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="24" Name="ID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="25" Name="schemeID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="26" Name="Address" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cac:Address" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="27" Name="StreetName" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="28" Name="AdditionalStreetName" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:AdditionalStreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="29" Name="CityName" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:CityName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="30" Name="PostalZone" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:PostalZone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="31" Name="CountrySubentity" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:CountrySubentity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="32" Name="Country" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cac:Country" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="33" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cac:Country/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="34" Name="AllowanceCharge" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:AllowanceCharge" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="35" Name="ChargeIndicator" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:AllowanceCharge/cbc:ChargeIndicator" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="36" Name="AllowanceChargeReason" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:AllowanceCharge/cbc:AllowanceChargeReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="37" Name="Amount" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:AllowanceCharge/cbc:Amount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="38" Name="currencyID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:AllowanceCharge/cbc:Amount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="39" Name="Item" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="40" Name="Description" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cbc:Description" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="41" Name="Name" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="42" Name="SellersItemIdentification" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:SellersItemIdentification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="43" Name="ID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:SellersItemIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="44" Name="StandardItemIdentification" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:StandardItemIdentification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="45" Name="ID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:StandardItemIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="46" Name="schemeID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:StandardItemIdentification/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="47" Name="OriginCountry" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:OriginCountry" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="48" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:OriginCountry/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="49" Name="listID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:OriginCountry/cbc:IdentificationCode[@listID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="50" Name="CommodityClassification" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:CommodityClassification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="51" Name="CommodityCode" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:CommodityClassification/cbc:CommodityCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="52" Name="listID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:CommodityClassification/cbc:CommodityCode[@listID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="53" Name="ItemClassificationCode" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:CommodityClassification/cbc:ItemClassificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="54" Name="listID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:CommodityClassification/cbc:ItemClassificationCode[@listID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="55" Name="ClassifiedTaxCategory" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:ClassifiedTaxCategory" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="56" Name="ID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:ClassifiedTaxCategory/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="57" Name="Percent" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:ClassifiedTaxCategory/cbc:Percent" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="58" Name="TaxScheme" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:ClassifiedTaxCategory/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="59" Name="ID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:ClassifiedTaxCategory/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="60" Name="AdditionalItemProperty" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:AdditionalItemProperty" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="61" Name="Name" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:AdditionalItemProperty/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="62" Name="Value" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Item/cac:AdditionalItemProperty/cbc:Value" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="63" Name="Price" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="64" Name="PriceAmount" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cbc:PriceAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="65" Name="currencyID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cbc:PriceAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="66" Name="BaseQuantity" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cbc:BaseQuantity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="67" Name="unitCode" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cbc:BaseQuantity[@unitCode]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="68" Name="AllowanceCharge" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cac:AllowanceCharge" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="69" Name="ChargeIndicator" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cac:AllowanceCharge/cbc:ChargeIndicator" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="70" Name="Amount" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cac:AllowanceCharge/cbc:Amount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="71" Name="currencyID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cac:AllowanceCharge/cbc:Amount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="72" Name="BaseAmount" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cac:AllowanceCharge/cbc:BaseAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="73" Name="currencyID" Show="false" DataType="0" Path="/cac:CreditNoteLine/cac:Price/cac:AllowanceCharge/cbc:BaseAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="115" Name="" MappingCodeunit="1269" PreMappingCodeunit="6157"><DataExchFieldMapping ColumnNo="2" FieldID="4" /><DataExchFieldMapping ColumnNo="3" FieldID="5" Optional="true" /><DataExchFieldMapping ColumnNo="4" FieldID="15" /><DataExchFieldMapping ColumnNo="5" FieldID="5407" Optional="true" TransformationRule="LOOKUPUOMINTCODE"><TransformationRules><Code>LOOKUPUOMINTCODE</Code><Description>Lookup UOM international code</Description><TransformationType>13</TransformationType><FindValue /><ReplaceValue /><StartPosition>0</StartPosition><Length>0</Length><DataFormat /><DataFormattingCulture /><NextTransformationRule /><TableID>204</TableID><SourceFieldID>1</SourceFieldID><TargetFieldID>3</TargetFieldID><FieldLookupRule>0</FieldLookupRule><Precision>0.00</Precision><Direction /><ExportFromDateType>0</ExportFromDateType></TransformationRules></DataExchFieldMapping><DataExchFieldMapping ColumnNo="6" FieldID="103" Optional="true" /><DataExchFieldMapping ColumnNo="40" FieldID="12" Optional="true" /><DataExchFieldMapping ColumnNo="41" FieldID="11" Optional="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="15-TAXSUBTOTAL-LINES" Name="Tax Subtotal" ColumnCount="0" DataLineTag="//cac:TaxTotal" ParentCode="14-TAXTOTAL"><DataExchColumnDef ColumnNo="1" Name="TaxSubtotal" Show="false" DataType="0" Path="/cac:TaxSubtotal" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="TaxableAmount" Show="false" DataType="0" Path="/cac:TaxSubtotal/cbc:TaxableAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="currencyID" Show="false" DataType="0" Path="/cac:TaxSubtotal/cbc:TaxableAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="TaxAmount" Show="false" DataType="0" Path="/cac:TaxSubtotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="currencyID" Show="false" DataType="0" Path="/cac:TaxSubtotal/cbc:TaxAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="TaxCategory" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="ID" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="Percent" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cbc:Percent" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="TaxExemptionReason" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cbc:TaxExemptionReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="TaxScheme" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="ID" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="2000000026" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef></DataExchDef></root>', Locked = true;
        DataExchangeXMLSalInvExp1Txt: Label '<?xml version="1.0" encoding="UTF-8" standalone="no"?><root><DataExchDef Code="%1" Name="%2" Type="5" ExternalDataHandlingCodeunit="6155" FileType="0" ReadingWritingCodeunit="1283"><DataExchLineDef LineType="1" Code="01-INVOICE" Name="Invoice" ColumnCount="0" Namespace="urn:oasis:names:specification:ubl:schema:xsd:Invoice-2"><DataExchColumnDef ColumnNo="1" Name="Invoice" Show="false" DataType="0" Path="/Invoice" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="false" /><DataExchColumnDef ColumnNo="2" Name="CustomizationID" Show="false" DataType="0" Path="/Invoice/cbc:CustomizationID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="ProfileID" Show="false" DataType="0" Path="/Invoice/cbc:ProfileID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="ID" Show="false" DataType="0" Path="/Invoice/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="IssueDate" Show="false" DataType="1" Path="/Invoice/cbc:IssueDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="DueDate" Show="false" DataType="1" Path="/Invoice/cbc:DueDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="InvoiceTypeCode" Show="false" DataType="0" Path="/Invoice/cbc:InvoiceTypeCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="Note" Show="false" DataType="0" Path="/Invoice/cbc:Note" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="TaxPointDate" Show="false" DataType="0" Path="/Invoice/cbc:TaxPointDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="DocumentCurrencyCode" Show="false" DataType="0" Path="/Invoice/cbc:DocumentCurrencyCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="TaxCurrencyCode" Show="false" DataType="0" Path="/Invoice/cbc:TaxCurrencyCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="AccountingCost" Show="false" DataType="0" Path="/Invoice/cbc:AccountingCost" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="BuyerReference" Show="false" DataType="0" Path="/Invoice/cbc:BuyerReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="2" UseDefaultValue="true" DefaultValue="urn:cen.eu:en16931:2017#compliant#urn:fdc:peppol.eu:2017:poacc:billing:3.0" /><DataExchFieldMapping ColumnNo="3" UseDefaultValue="true" DefaultValue="urn:fdc:peppol.eu:2017:poacc:billing:01:1.0" /><DataExchFieldMapping ColumnNo="4" FieldID="3" /><DataExchFieldMapping ColumnNo="5" FieldID="99" /><DataExchFieldMapping ColumnNo="6" FieldID="24" Optional="true" /><DataExchFieldMapping ColumnNo="7" UseDefaultValue="true" DefaultValue="380" /><DataExchFieldMapping ColumnNo="10" FieldID="32" Optional="true" /><DataExchFieldMapping ColumnNo="13" FieldID="11" Optional="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="02-INVPERIOD" Name="Invoice Period" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="InvoicePeriod" Show="false" DataType="0" Path="/cac:InvoicePeriod" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="StartDate" Show="false" DataType="1" Path="/cac:InvoicePeriod/cbc:StartDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="EndDate" Show="false" DataType="1" Path="/cac:InvoicePeriod/cbc:EndDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="2" UseDefaultValue="true" /><DataExchFieldMapping ColumnNo="3" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="03-ORDREF" Name="Order Reference" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="OrderReference" Show="false" DataType="0" Path="/cac:OrderReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ID" Show="false" DataType="0" Path="/cac:OrderReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="2" FieldID="100" Optional="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="04-CONTDOCREF" Name="Contract Document Reference" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="ContractDocumentReference" Show="false" DataType="0" Path="/cac:ContractDocumentReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ID" Show="false" DataType="0" Path="/cac:ContractDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="2" FieldID="3" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="05-ADDDOCREF" Name="Additional Document Reference" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="AdditionalDocumentReference" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ID" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="DocumentType" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cbc:DocumentType" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="Attachment" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="EmbeddedDocumentBinaryObject" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="ExternalReference" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cac:ExternalReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="URI" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cac:ExternalReference/cbc:URI" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="MimeCode" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject[@mimeCode]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="Filename" Show="false" DataType="0" Path="/cac:AdditionalDocumentReference/cac:Attachment/cbc:EmbeddedDocumentBinaryObject[@filename]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="1173" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="06-ACCSUPPPARTY" Name="Accounting Supplier Party" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="AccountingSupplierParty" Show="false" DataType="0" Path="/cac:AccountingSupplierParty" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="Party" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="EndpointID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cbc:EndpointID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cbc:EndpointID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="PartyIdentification" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="ID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="PartyName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="Name" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="PostalAddress" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="StreetName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="AdditionalStreetName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:AdditionalStreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="CityName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CityName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="14" Name="PostalZone" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:PostalZone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="15" Name="CountrySubentity" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="16" Name="Country" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cac:Country" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="17" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PostalAddress/cac:Country/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="18" Name="PartyTaxScheme" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="19" Name="CompanyID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="20" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="21" Name="ExemptionReason" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cbc:ExemptionReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="22" Name="TaxScheme" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="23" Name="ID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="24" Name="PartyLegalEntity" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="25" Name="RegistrationName" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:RegistrationName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="26" Name="CompanyID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="27" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="28" Name="Contact" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="29" Name="Name" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="30" Name="Telephone" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:Telephone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="31" Name="Telefax" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:Telefax" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="32" Name="ElectronicMail" Show="false" DataType="0" Path="/cac:AccountingSupplierParty/cac:Party/cac:Contact/cbc:ElectronicMail" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="79" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="9" FieldID="2" /><DataExchFieldMapping ColumnNo="25" FieldID="2" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="07-ACCCUSTPARTY" Name="Accounting Customer Party" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="AccountingSupplierParty" Show="false" DataType="0" Path="/cac:AccountingCustomerParty" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="Party" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="EndpointID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cbc:EndpointID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cbc:EndpointID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="PartyIdentification" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="ID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyIdentification/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="PartyName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="Name" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="PostalAddress" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="StreetName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="AdditionalStreetName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:AdditionalStreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="CityName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:CityName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="14" Name="PostalZone" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:PostalZone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="15" Name="CountrySubentity" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cbc:CountrySubentity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="16" Name="Country" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cac:Country" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="17" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PostalAddress/cac:Country/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="18" Name="PartyTaxScheme" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="19" Name="CompanyID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="20" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="21" Name="ExemptionReason" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cbc:ExemptionReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="22" Name="TaxScheme" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="23" Name="ID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyTaxScheme/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="24" Name="PartyLegalEntity" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="25" Name="RegistrationName" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:RegistrationName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="26" Name="CompanyID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="27" Name="schemeID" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:PartyLegalEntity/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="28" Name="Contact" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="29" Name="Name" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="30" Name="Telephone" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:Telephone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="31" Name="Telefax" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:Telefax" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="32" Name="ElectronicMail" Show="false" DataType="0" Path="/cac:AccountingCustomerParty/cac:Party/cac:Contact/cbc:ElectronicMail" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="9" FieldID="5" /><DataExchFieldMapping ColumnNo="11" FieldID="7" /><DataExchFieldMapping ColumnNo="12" FieldID="8" Optional="true" /><DataExchFieldMapping ColumnNo="13" FieldID="9" /><DataExchFieldMapping ColumnNo="14" FieldID="85" /><DataExchFieldMapping ColumnNo="15" FieldID="86" Optional="true" /><DataExchFieldMapping ColumnNo="17" FieldID="87" TransformationRule="LOOKUPISOCOUTRYCODE"><TransformationRules><Code>LOOKUPISOCOUTRYCODE</Code><Description>Lookup ISO Country code</Description><TransformationType>13</TransformationType><FindValue /><ReplaceValue /><StartPosition>0</StartPosition><Length>0</Length><DataFormat /><DataFormattingCulture /><NextTransformationRule /><TableID>9</TableID><SourceFieldID>1</SourceFieldID><TargetFieldID>4</TargetFieldID><FieldLookupRule>0</FieldLookupRule><Precision>0.00</Precision><Direction /><ExportFromDateType>0</ExportFromDateType></TransformationRules></DataExchFieldMapping></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="08-TAXREPRPARTY" Name="Tax Representative Party" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="TaxRepresentativeParty" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="PartyName" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="Name" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyName/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="PartyTaxScheme" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="CompanyID" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme/cbc:CompanyID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="schemeID" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme/cbc:CompanyID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="TaxScheme" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="ID" Show="false" DataType="0" Path="/cac:TaxRepresentativeParty/cac:PartyTaxScheme/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="09-DELIVERY" Name="Delivery" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="Delivery" Show="false" DataType="0" Path="/cac:Delivery" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ActualDeliveryDate" Show="false" DataType="0" Path="/cac:Delivery/cbc:ActualDeliveryDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="DeliveryLocation" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="ID" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="schemeID" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="Address" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="StreetName" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="AdditionalStreetName" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:AdditionalStreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="CityName" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:CityName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="PostalZone" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:PostalZone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="CountrySubentity" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:CountrySubentity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="Country" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cac:Country" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:Delivery/cac:DeliveryLocation/cac:Address/cac:Country/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="7" FieldID="15" /><DataExchFieldMapping ColumnNo="8" FieldID="16" Optional="true" /><DataExchFieldMapping ColumnNo="9" FieldID="17" /><DataExchFieldMapping ColumnNo="10" FieldID="91" /><DataExchFieldMapping ColumnNo="11" FieldID="92" Optional="true" /><DataExchFieldMapping ColumnNo="13" FieldID="93" TransformationRule="LOOKUPISOCOUTRYCODE"><TransformationRules><Code>LOOKUPISOCOUTRYCODE</Code><Description>Lookup ISO Country code</Description><TransformationType>13</TransformationType><FindValue /><ReplaceValue /><StartPosition>0</StartPosition><Length>0</Length><DataFormat /><DataFormattingCulture /><NextTransformationRule /><TableID>9</TableID><SourceFieldID>1</SourceFieldID><TargetFieldID>4</TargetFieldID><FieldLookupRule>0</FieldLookupRule><Precision>0.00</Precision><Direction /><ExportFromDateType>0</ExportFromDateType></TransformationRules></DataExchFieldMapping></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="10-PMTMEANS" Name="Payment Means" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="PaymentMeans" Show="false" DataType="0" Path="/cac:PaymentMeans" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="PaymentMeansCode" Show="false" DataType="0" Path="/cac:PaymentMeans/cbc:PaymentMeansCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="PaymentChannelCode" Show="false" DataType="0" Path="/cac:PaymentMeans/cbc:PaymentChannelCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="PaymentID" Show="false" DataType="0" Path="/cac:PaymentMeans/cbc:PaymentID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="CardAccount" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:CardAccount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="PrimaryAccountNumberID" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:CardAccount/cbc:PrimaryAccountNumberID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="NetworkID" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:CardAccount/cbc:NetworkID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="PayeeFinancialAccount" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:PayeeFinancialAccount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="ID" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:PayeeFinancialAccount/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="FinancialInstitutionBranch" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:PayeeFinancialAccount/cac:FinancialInstitutionBranch" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="ID" Show="false" DataType="0" Path="/cac:PaymentMeans/cac:PayeeFinancialAccount/cac:FinancialInstitutionBranch/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="11-PMTTERMS" Name="Payment Terms" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="PaymentTerms" Show="false" DataType="0" Path="/cac:PaymentTerms" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="Note" Show="false" DataType="0" Path="/cac:PaymentTerms/cbc:Note" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="12-ALLCHARGE" Name="Allowance Charge" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="AllowanceCharge" Show="false" DataType="0" Path="/cac:AllowanceCharge" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ChargeIndicator" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:ChargeIndicator" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="AllowanceChargeReasonCode" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:AllowanceChargeReasonCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="AllowanceChargeReason" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:AllowanceChargeReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="Amount" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:Amount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="currencyID" Show="false" DataType="0" Path="/cac:AllowanceCharge/cbc:Amount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="TaxCategory" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="ID" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="Percent" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory/cbc:Percent" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="TaxScheme" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="ID" Show="false" DataType="0" Path="/cac:AllowanceCharge/cac:TaxCategory/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="2000000026" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="13-TAXTOTAL" Name="Tax Total" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="TaxTotal" Show="false" DataType="0" Path="/cac:TaxTotal" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="TaxAmount" Show="false" DataType="0" Path="/cac:TaxTotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="currencyID" Show="false" DataType="0" Path="/cac:TaxTotal/cbc:TaxAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="15-TAXTOTALLCY" Name="Tax Total LCY" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="TaxTotal" Show="false" DataType="0" Path="/cac:TaxTotal" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="TaxAmount" Show="false" DataType="0" Path="/cac:TaxTotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="currencyID" Show="false" DataType="0" Path="/cac:TaxTotal/cbc:TaxAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="1" Code="16-LEGALMONTOTAL" Name="Legal Monetary Total" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="LegalMonetaryTotal" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="LineExtensionAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:LineExtensionAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:LineExtensionAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="TaxExclusiveAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:TaxExclusiveAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:TaxExclusiveAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="TaxInclusiveAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:TaxInclusiveAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:TaxInclusiveAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="AllowanceTotalAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:AllowanceTotalAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:AllowanceTotalAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="ChargeTotalAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:ChargeTotalAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:ChargeTotalAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="PrepaidAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PrepaidAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PrepaidAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="14" Name="PayableRoundingAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PayableRoundingAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="15" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PayableRoundingAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="16" Name="PayableAmount" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PayableAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="17" Name="currencyID" Show="false" DataType="0" Path="/cac:LegalMonetaryTotal/cbc:PayableAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="112" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="17-INVOICE-LINES" Name="Invoice Lines" ColumnCount="0" DataLineTag="/Invoice" ParentCode="01-INVOICE"><DataExchColumnDef ColumnNo="1" Name="Line" Show="false" DataType="0" Path="/cac:InvoiceLine" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="ID" Show="false" DataType="2" Path="/cac:InvoiceLine/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="Note" Show="false" DataType="0" Path="/cac:InvoiceLine/cbc:Note" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="InvoicedQuantity" Show="false" DataType="2" Path="/cac:InvoiceLine/cbc:InvoicedQuantity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="unitCode" Show="false" DataType="0" Path="/cac:InvoiceLine/cbc:InvoicedQuantity[@unitCode]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="LineExtensionAmount" Show="false" DataType="2" Description="Set to line amount" Path="/cac:InvoiceLine/cbc:LineExtensionAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="currencyID" Show="false" DataType="0" Path="/cac:InvoiceLine/cbc:LineExtensionAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="AccountingCost" Show="false" DataType="0" Path="/cac:InvoiceLine/cbc:AccountingCost" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="InvoicePeriod" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:InvoicePeriod" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="StartDate" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:InvoicePeriod/cbc:StartDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="EndDate" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:InvoicePeriod/cbc:EndDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="12" Name="OrderLineReference" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:OrderLineReference" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="13" Name="LineID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:OrderLineReference/cbc:LineID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="14" Name="Delivery" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="15" Name="ActualDeliveryDate" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cbc:ActualDeliveryDate" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="16" Name="DeliveryLocation" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="17" Name="ID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="18" Name="schemeID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="19" Name="Address" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cac:Address" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="20" Name="StreetName" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:StreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="21" Name="AdditionalStreetName" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:AdditionalStreetName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="22" Name="CityName" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:CityName" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="23" Name="PostalZone" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:PostalZone" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="24" Name="CountrySubentity" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cbc:CountrySubentity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="25" Name="Country" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cac:Country" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="26" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Delivery/cac:DeliveryLocation/cac:Address/cac:Country/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="27" Name="AllowanceCharge" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:AllowanceCharge" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="28" Name="ChargeIndicator" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:AllowanceCharge/cbc:ChargeIndicator" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="29" Name="AllowanceChargeReason" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:AllowanceCharge/cbc:AllowanceChargeReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="30" Name="Amount" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:AllowanceCharge/cbc:Amount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="31" Name="currencyID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:AllowanceCharge/cbc:Amount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="32" Name="Item" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="33" Name="Description" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cbc:Description" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="34" Name="Name" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="35" Name="SellersItemIdentification" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:SellersItemIdentification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="36" Name="ID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:SellersItemIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="37" Name="StandardItemIdentification" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:StandardItemIdentification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="38" Name="ID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:StandardItemIdentification/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="39" Name="schemeID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:StandardItemIdentification/cbc:ID[@schemeID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="40" Name="OriginCountry" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:OriginCountry" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="41" Name="IdentificationCode" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:OriginCountry/cbc:IdentificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="42" Name="listID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:OriginCountry/cbc:IdentificationCode[@listID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="43" Name="CommodityClassification" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:CommodityClassification" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="44" Name="CommodityCode" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:CommodityClassification/cbc:CommodityCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="45" Name="listID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:CommodityClassification/cbc:CommodityCode[@listID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="46" Name="ItemClassificationCode" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:CommodityClassification/cbc:ItemClassificationCode" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="47" Name="listID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:CommodityClassification/cbc:ItemClassificationCode[@listID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="48" Name="ClassifiedTaxCategory" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:ClassifiedTaxCategory" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="49" Name="ID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:ClassifiedTaxCategory/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="50" Name="Percent" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:ClassifiedTaxCategory/cbc:Percent" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="51" Name="TaxScheme" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:ClassifiedTaxCategory/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="52" Name="ID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:ClassifiedTaxCategory/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="53" Name="AdditionalItemProperty" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:AdditionalItemProperty" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="54" Name="Name" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:AdditionalItemProperty/cbc:Name" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="55" Name="Value" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Item/cac:AdditionalItemProperty/cbc:Value" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="56" Name="Price" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="57" Name="PriceAmount" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cbc:PriceAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="58" Name="currencyID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cbc:PriceAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="59" Name="BaseQuantity" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cbc:BaseQuantity" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="60" Name="unitCode" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cbc:BaseQuantity[@unitCode]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="61" Name="AllowanceCharge" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cac:AllowanceCharge" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="62" Name="ChargeIndicator" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cac:AllowanceCharge/cbc:ChargeIndicator" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="63" Name="Amount" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cac:AllowanceCharge/cbc:Amount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="64" Name="currencyID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cac:AllowanceCharge/cbc:Amount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="65" Name="BaseAmount" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cac:AllowanceCharge/cbc:BaseAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="66" Name="currencyID" Show="false" DataType="0" Path="/cac:InvoiceLine/cac:Price/cac:AllowanceCharge/cbc:BaseAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="113" Name="" MappingCodeunit="1269" PreMappingCodeunit="6158"><DataExchFieldMapping ColumnNo="2" FieldID="4" /><DataExchFieldMapping ColumnNo="3" FieldID="5" Optional="true" /><DataExchFieldMapping ColumnNo="4" FieldID="15" /><DataExchFieldMapping ColumnNo="5" FieldID="5407" Optional="true" TransformationRule="LOOKUPUOMINTCODE"><TransformationRules><Code>LOOKUPUOMINTCODE</Code><Description>Lookup UOM international code</Description><TransformationType>13</TransformationType><FindValue /><ReplaceValue /><StartPosition>0</StartPosition><Length>0</Length><DataFormat /><DataFormattingCulture /><NextTransformationRule /><TableID>204</TableID><SourceFieldID>1</SourceFieldID><TargetFieldID>3</TargetFieldID><FieldLookupRule>0</FieldLookupRule><Precision>0.00</Precision><Direction /><ExportFromDateType>0</ExportFromDateType></TransformationRules></DataExchFieldMapping><DataExchFieldMapping ColumnNo="6" FieldID="103" Optional="true" /><DataExchFieldMapping ColumnNo="33" FieldID="12" Optional="true" /><DataExchFieldMapping ColumnNo="34" FieldID="11" Optional="true" /></DataExchMapping></DataExchLineDef><DataExchLineDef LineType="0" Code="14-TAXSUBTOTAL-LINES" Name="Tax Subtotal" ColumnCount="0" DataLineTag="//cac:TaxTotal" ParentCode="13-TAXTOTAL"><DataExchColumnDef ColumnNo="1" Name="TaxSubtotal" Show="false" DataType="0" Path="/cac:TaxSubtotal" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="2" Name="TaxableAmount" Show="false" DataType="0" Path="/cac:TaxSubtotal/cbc:TaxableAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="3" Name="currencyID" Show="false" DataType="0" Path="/cac:TaxSubtotal/cbc:TaxableAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="4" Name="TaxAmount" Show="false" DataType="0" Path="/cac:TaxSubtotal/cbc:TaxAmount" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="5" Name="currencyID" Show="false" DataType="0" Path="/cac:TaxSubtotal/cbc:TaxAmount[@currencyID]" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="6" Name="TaxCategory" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="7" Name="ID" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="8" Name="Percent" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cbc:Percent" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="9" Name="TaxExemptionReason" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cbc:TaxExemptionReason" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="10" Name="TaxScheme" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cac:TaxScheme" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchColumnDef ColumnNo="11" Name="ID" Show="false" DataType="0" Path="/cac:TaxSubtotal/cac:TaxCategory/cac:TaxScheme/cbc:ID" TextPaddingRequired="false" Justification="0" UseNodeNameAsValue="false" BlankZero="false" ExportIfNotBlank="true" /><DataExchMapping TableId="2000000026" Name="" MappingCodeunit="1269"><DataExchFieldMapping ColumnNo="1" UseDefaultValue="true" /></DataExchMapping></DataExchLineDef></DataExchDef></root>', Locked = true;
        XMLOutStream: OutStream;
        DxTxt: Text;
        XmlStr: Text;
    begin
        Clear(DataExchDef);
        Clear(TempBlob);
        Clear(XMLInStream);
        Clear(XMLOutStream);
        Clear(DxTxt);
        Clear(XmlStr);
        DeleteDataExchDefIfExists(Mandate);
        ImportDataExchDefFromXmlTemplate(DataExchangeXMLSalInvExp1Txt, Mandate, Mandate + ' Sales Invoice');

        DeleteDataExchDefIfExists(Mandate + 'SCM');
        ImportDataExchDefFromXmlTemplate(DataExchangeXMLSalCrMemoExp1Txt, Mandate, Mandate + 'Sales CR Memo');

        DeleteDataExchDefIfExists(Mandate + 'PINV');
        ImportDataExchDefFromXmlTemplate(DataExchangeInvXML1Txt, Mandate, Mandate + 'Purchase Invoice');

        DeleteDataExchDefIfExists(Mandate + 'PCM');
        ImportDataExchDefFromXmlTemplate(DataExchangeCrMXML1Txt, Mandate, Mandate + 'Purchase Credit Memo');
    end;

    local procedure DeleteDataExchDefIfExists(DefCodeText: Text)
    var
        DataExchDef: Record "Data Exch. Def";
        DefCode: Code[20];
    begin
        DefCode := CopyStr(DefCodeText, 1, MaxStrLen(DefCode));
        if DataExchDef.Get(DefCode) then
            DataExchDef.Delete(true);
    end;

    local procedure ImportDataExchDefFromXmlTemplate(XmlTemplate: Text; Mandate: Text; DisplayName: Text)
    var
        TempBlob: Codeunit "Temp Blob";
        XMLInStream: InStream;
        XMLOutStream: OutStream;
        DxTxt: Text;
    begin
        DxTxt := StrSubstNo(XmlTemplate, Mandate, DisplayName);
        TempBlob.CreateOutStream(XMLOutStream);
        XMLOutStream.WriteText(DxTxt);
        TempBlob.CreateInStream(XMLInStream);
        Xmlport.Import(Xmlport::"Imp / Exp Data Exch Def & Map", XMLInStream);
    end;

    [EventSubscriber(ObjectType::Table, Database::"Document Attachment", OnBeforeInsertAttachment, '', false, false)]
    local procedure "Document Attachment_OnBeforeInsertAttachment"(var DocumentAttachment: Record "Document Attachment"; var RecRef: RecordRef)
    var
        EDocument: Record "E-Document";
    begin
        DocumentAttachment."E-Document Attachment" := true;
        if RecRef.Number = Database::"E-Document" then begin
            RecRef.SetTable(EDocument);
            DocumentAttachment."E-Document Entry No." := EDocument."Entry No";
        end;
    end;

    procedure ScheduleForEDocument(var EDocument: Record "E-Document")
    var
        JobQueueEntry: Record "Job Queue Entry";
    begin
        JobQueueEntry.Init();
        JobQueueEntry."Job Queue Category Code" := '';
        JobQueueEntry."Object Type to Run" := JobQueueEntry."Object Type to Run"::Codeunit;
        JobQueueEntry."Record ID to Process" := EDocument.RecordId;
        JobQueueEntry."Earliest Start Date/Time" := (CreateDateTime(WorkDate(), Time) + (5 * 60000));
        JobQueueEntry."Maximum No. of Attempts to Run" := 3;
        JobQueueEntry."No. of Minutes between Runs" := 0;
        JobQueueEntry."Recurring Job" := false;
        JobQueueEntry.Insert(true);

        EDocument.Modify(true);
    end;

    [EventSubscriber(ObjectType::Codeunit, Codeunit::"E-Doc. Export", OnBeforeCreateEDocument, '', false, false)]
    local procedure EDocExportOnBeforeCreateEDocument(var EDocument: Record "E-Document"; var SourceDocumentHeader: RecordRef)
    var
        Customer: Record Customer;
        DocumentSendingProfile: Record "Document Sending Profile";
        FinChargeMemoHeader: Record "Finance Charge Memo Header";
        PurchaseHeader: Record "Purchase Header";
        SalesHeader: Record "Sales Header";
        WorkFlow: Record Workflow;
        WorkFlowStep: Record "Workflow Step";
        WorkFlowStepArg: Record "Workflow Step Argument";
        RecRef: RecordRef;
        CustomerNo, VendorNo : Text;
        EnabledFlowCode, RequiredFlowCode : Text;

    begin

        RecRef := SourceDocumentHeader;
        WorkFlow.SetFilter(Category, WorkflowCategoryEDocTok);
        WorkFlow.SetFilter(Enabled, FilterValueTrueTok);
        if WorkFlow.FindFirst() then
            EnabledFlowCode := WorkFlow.Code;

        CustomerNo := '';
        VendorNo := '';

        case RecRef.Number of
            Database::"Sales Header", Database::"Sales Invoice Header":
                CustomerNo := RecRef.Field(SalesHeader.FieldNo("Bill-to Customer No.")).Value;
            Database::"Service Header", Database::"Service Invoice Header", Database::"Service Cr.Memo Header":
                CustomerNo := RecRef.Field(SalesHeader.FieldNo("Bill-to Customer No.")).Value;
            Database::"Finance Charge Memo Header", Database::"Issued Fin. Charge Memo Header", Database::"Reminder Header", Database::"Issued Reminder Header":
                CustomerNo := RecRef.Field(FinChargeMemoHeader.FieldNo("Customer No.")).Value;
            Database::"Purchase Header", Database::"Purch. Inv. Header", Database::"Purch. Cr. Memo Hdr.":
                VendorNo := RecRef.Field(PurchaseHeader.FieldNo("Pay-to Vendor No.")).Value;
        end;

        if CustomerNo <> '' then
            if Customer.Get(CustomerNo) then
                if DocumentSendingProfile.Get(Customer."Document Sending Profile") then begin
                    RequiredFlowCode := DocumentSendingProfile."Electronic Service Flow";
                    if RequiredFlowCode <> '' then
                        if WorkFlow.Get(RequiredFlowCode) then begin
                            WorkFlowStep.SetFilter("Workflow Code", RequiredFlowCode);
                            WorkFlowStep.SetFilter("Function Name", 'EDOCSENDEDOCRESPONSE');
                            WorkFlowStepArg.SetFilter("E-Document Service", '<>%1', '');
                            if WorkFlowStepArg.FindSet() then
                                repeat
                                    EnabledFlowCode := WorkFlowStepArg."Response Function Name";
                                until WorkFlowStepArg.Next() = 0;
                        end;
                end;
    end;

    procedure EnsureMaintenanceJobQueueEntry()
    var
        JobQueueEntry: Record "Job Queue Entry";
    begin
        // Look for an existing entry for Codeunit 6373
        JobQueueEntry.Reset();
        JobQueueEntry.SetRange("Object Type to Run", JobQueueEntry."Object Type to Run"::Codeunit);
        JobQueueEntry.SetRange("Object ID to Run", Codeunit::Maintenance);

        if not JobQueueEntry.IsEmpty then begin
            Message(
              JobQueueExistsMsg,
              JobQueueEntry."Entry No.", JobQueueEntry."Object ID to Run");
            exit;
        end;

        // Create a new Job Queue Entry
        JobQueueEntry.Init();
        JobQueueEntry.Insert(true);

        JobQueueEntry.Validate("Object Type to Run", JobQueueEntry."Object Type to Run"::Codeunit);
        JobQueueEntry.Validate("Object ID to Run", Codeunit::Maintenance);
        JobQueueEntry.Description := FetchAvalaraDocsDescTxt;

        // Optional category  remove or change if you dont have AVALARA defined
        // JobQueueEntry.Validate("Job Queue Category Code", 'AVALARA');

        JobQueueEntry."User ID" := CopyStr(UserId(), 1, MaxStrLen(JobQueueEntry."User ID"));
        JobQueueEntry."Earliest Start Date/Time" := CurrentDateTime;
        JobQueueEntry."Recurring Job" := true;
        JobQueueEntry."Run on Mondays" := true;
        JobQueueEntry."Run on Tuesdays" := true;
        JobQueueEntry."Run on Wednesdays" := true;
        JobQueueEntry."Run on Thursdays" := true;
        JobQueueEntry."Run on Fridays" := true;
        JobQueueEntry."Run on Saturdays" := true;
        JobQueueEntry."Run on Sundays" := true;
        JobQueueEntry."No. of Minutes between Runs" := 5; //  change interval here
        JobQueueEntry."Maximum No. of Attempts to Run" := 3;

        JobQueueEntry.Validate(Status, JobQueueEntry.Status::Ready);

        JobQueueEntry.Modify(true);

        Message(
          JobQueueCreatedMsg,
          JobQueueEntry."Entry No.", JobQueueEntry."Object ID to Run", JobQueueEntry."No. of Minutes between Runs");
    end;

    procedure GetSafeFilenameWithExtension(FileId: Text; MediaType: Text): Text
    var
        FileExt: Text;
        Normalized: Text;
    begin
        // Normalize media subtype (strip "application/")
        if MediaType.StartsWith('application/') then
            Normalized := MediaType.Substring(13)
        else
            Normalized := MediaType;

        // Replace invalid filename chars
        Normalized := Normalized.Replace('.', '_');
        Normalized := Normalized.Replace('+', '-');

        // Determine file extension
        FileExt := GetFileExtensionFromMediaType(MediaType);

        exit(StrSubstNo(SafeFilenameFormatMsg, FileId, Normalized, FileExt));
    end;

    local procedure GetFileExtensionFromMediaType(MediaType: Text): Text
    var
        SemiPos: Integer;
        BaseType: Text;
    begin
        // Normalise (trim + lower)
        BaseType := LowerCase(DelChr(MediaType, '<>', ' '));

        // Strip parameters e.g. "application/json; charset=utf-8"
        SemiPos := StrPos(BaseType, ';');
        if SemiPos > 0 then
            BaseType := CopyStr(BaseType, 1, SemiPos - 1);

        // Some services send empty / unknown
        if BaseType = '' then
            exit('.bin');

        // Exact matches (most common)
        case BaseType of
            'application/pdf':
                exit('.pdf');

            'application/zip', 'application/x-zip-compressed':
                exit('.zip');

            'application/xml', 'text/xml':
                exit('.xml');

            'application/json':
                exit('.json');

            'image/png':
                exit('.png');

            'image/jpeg', 'image/jpg':
                exit('.jpg');

            'image/gif':
                exit('.gif');

            'text/plain':
                exit('.txt');

            'text/csv':
                exit('.csv');

            'text/html':
                exit('.html');
        end;

        // Structured syntax suffixes: application/*+xml, application/*+json
        if BaseType.EndsWith('+xml') then
            exit('.xml');

        if BaseType.EndsWith('+json') then
            exit('.json');

        // Text family fallback (e.g. text/markdown, text/calendar, etc.)
        if BaseType.StartsWith('text/') then
            exit('.txt');

        // Conservative default
        exit('.bin');
    end;

    [EventSubscriber(ObjectType::Table, Database::"Transformation Rule", 'OnTransformation', '', false, false)]
    local procedure OnTransformation(TransformationCode: Code[20]; InputText: Text; var OutputText: Text)
    var
        TransformationRule: Record "Transformation Rule";
        RecRef: RecordRef;
        PrimaryFieldRef: FieldRef;
        ResultFieldRef: FieldRef;
        SecondaryFieldRef: FieldRef;
    begin
        if not TransformationRule.Get(TransformationCode) then
            exit;

        if TransformationRule."Transformation Type" <> TransformationRule."Transformation Type"::"Avalara Lookup" then
            exit;

        // Validate configuration
        if TransformationRule."Lookup Table ID" = 0 then
            Error('Lookup Table ID must be specified for Advanced Lookup transformation %1.', TransformationCode);

        if TransformationRule."Primary Field No." = 0 then
            Error('Primary Field No. must be specified for Advanced Lookup transformation %1.', TransformationCode);

        if TransformationRule."Result Field No." = 0 then
            Error('Result Field No. must be specified for Advanced Lookup transformation %1.', TransformationCode);

        // Perform the lookup
        RecRef.Open(TransformationRule."Lookup Table ID");

        // Set filter on primary field (match input value)
        PrimaryFieldRef := RecRef.Field(TransformationRule."Primary Field No.");
        //PrimaryFieldRef.SetRange(InputText);
        PrimaryFieldRef.SetRange(InputText);

        // Set filter on secondary field if configured (match key)
        if (TransformationRule."Secondary Field No." <> 0) and (TransformationRule."Secondary Filter Value" <> '') then begin
            SecondaryFieldRef := RecRef.Field(TransformationRule."Secondary Field No.");
            SecondaryFieldRef.SetRange(TransformationRule."Secondary Filter Value");
        end;

        // Find first match
        if RecRef.FindFirst() then begin
            ResultFieldRef := RecRef.Field(TransformationRule."Result Field No.");
            OutputText := Format(ResultFieldRef.Value);
        end else
            OutputText := ''; // Return blank if no match found

        RecRef.Close();
    end;

    local procedure GetAvalaraDocumentId(AppliesToDocNo: Code[20]; AppliesToDocType: Enum "Gen. Journal Document Type"): Text[50]
    var
        EDocument: Record "E-Document";
    begin
        EDocument.SetLoadFields("Avalara Document Id");
        EDocument.SetRange("Document No.", AppliesToDocNo);

        case AppliesToDocType of
            AppliesToDocType::Invoice:
                EDocument.SetRange("Document Type", EDocument."Document Type"::"Sales Invoice");
        end;

        if EDocument.FindFirst() then
            exit(EDocument."Avalara Document Id");
    end;

    internal procedure IsAvalaraActive(): Boolean
    var
        EDocumentService: Record "E-Document Service";
    begin
        EDocumentService.SetLoadFields("Service Integration V2");
        EDocumentService.SetRange("Service Integration V2", EDocumentService."Service Integration V2"::Avalara);
        if not EDocumentService.IsEmpty then
            exit(true);
    end;


    [EventSubscriber(ObjectType::Table, Database::"Sales Header", 'OnAfterValidateEvent', 'Applies-to Doc. No.', true, true)]
    local procedure OnAfterValidateAppliesToDocNo(var Rec: Record "Sales Header")
    begin
        Rec."Avalara Doc. ID" := GetAvalaraDocumentId(Rec."Applies-to Doc. No.", Rec."Applies-to Doc. Type");
        Rec.Modify();
    end;

    [EventSubscriber(ObjectType::Codeunit, Codeunit::"Copy Document Mgt.", OnBeforeModifySalesHeader, '', false, false)]
    local procedure OnBeforeModifySalesHeader(var ToSalesHeader: Record "Sales Header"; FromDocNo: Code[20]; FromDocType: Option)
    var
        AppliesToDocType: Enum "Gen. Journal Document Type";
        SalesDocumentTypeFrom: Enum "Sales Document Type From";
    begin
        case FromDocType of
            SalesDocumentTypeFrom::Invoice.AsInteger():
                AppliesToDocType := AppliesToDocType::Invoice;
        end;

        ToSalesHeader."Avalara Doc. ID" := GetAvalaraDocumentId(FromDocNo, AppliesToDocType);
    end;

    [EventSubscriber(ObjectType::Table, Database::"Sales Header", OnAfterAppliesToDocNoOnLookup, '', false, false)]
    local procedure OnAfterAppliesToDocNoOnLookup(var SalesHeader: Record "Sales Header")
    begin
        SalesHeader."Avalara Doc. ID" := GetAvalaraDocumentId(SalesHeader."Applies-to Doc. No.", SalesHeader."Applies-to Doc. Type");
    end;

    [EventSubscriber(ObjectType::Codeunit, Codeunit::"Sales-Post", 'OnAfterSalesCrMemoHeaderInsert', '', false, false)]
    local procedure OnAfterSalesCrMemoHeaderInsert(var SalesCrMemoHeader: Record "Sales Cr.Memo Header"; SalesHeader: Record "Sales Header")
    begin
        SalesCrMemoHeader."Avalara Doc. ID" := SalesHeader."Avalara Doc. ID";
        SalesCrMemoHeader.Modify();
    end;
}